<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ou Yiming">

<title>Take-home Excercise 1: Creating data visualization beyond default – ISSS608-dex</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-967aea24b31ab567da8bf3a244303b25.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../Images/Dex_Coursework.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608-dex</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex00.html">
 <span class="dropdown-text">Hands-on Exercise 0</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07.html">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08.html">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09.html">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="https://public.tableau.com/views/In-class_Ex01_17371866977140/Dashboard1?:language=en-US&amp;:sid=&amp;:redirect=auth&amp;:display_count=n&amp;:origin=viz_share_link">
 <span class="dropdown-text">1. Intro to Tableau</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://public.tableau.com/views/In-class_Ex02_17377894914220/Dashboard1?:language=en-US&amp;:sid=&amp;:redirect=auth&amp;:display_count=n&amp;:origin=viz_share_link">
 <span class="dropdown-text">2. Creating Dashboards (Tableau)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">3. Creating Stories (Tableau)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">4. Boxplot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">5 Visual Analytics for Building Better Explanatory Models</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-project" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Project</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-project">    
        <li>
    <a class="dropdown-item" href="../../Project/Project_01/Project.html">
 <span class="dropdown-text">Project</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contact.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1. Overview</a>
  <ul class="collapse">
  <li><a href="#context" id="toc-context" class="nav-link" data-scroll-target="#context"><strong>1.1 Context</strong></a></li>
  <li><a href="#task" id="toc-task" class="nav-link" data-scroll-target="#task">1.2 Task</a></li>
  </ul></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">2. Getting Started</a>
  <ul class="collapse">
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link" data-scroll-target="#load-packages">2.1 Load packages</a></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data">2.2 Import data</a></li>
  <li><a href="#data-pre-processing" id="toc-data-pre-processing" class="nav-link" data-scroll-target="#data-pre-processing">2.2 Data pre-processing</a>
  <ul class="collapse">
  <li><a href="#glimpse-of-data" id="toc-glimpse-of-data" class="nav-link" data-scroll-target="#glimpse-of-data">2.2.1 Glimpse of Data</a></li>
  <li><a href="#removing-columns-with-no-description" id="toc-removing-columns-with-no-description" class="nav-link" data-scroll-target="#removing-columns-with-no-description">2.2.2 Removing columns with no description</a></li>
  <li><a href="#checking-for-duplicates-and-missing-values" id="toc-checking-for-duplicates-and-missing-values" class="nav-link" data-scroll-target="#checking-for-duplicates-and-missing-values">2.2.3 Checking for duplicates and missing values</a></li>
  <li><a href="#checking-of-data-structure" id="toc-checking-of-data-structure" class="nav-link" data-scroll-target="#checking-of-data-structure">2.2.4 Checking of data structure</a></li>
  <li><a href="#removing-outliers" id="toc-removing-outliers" class="nav-link" data-scroll-target="#removing-outliers">2.2.5 Removing Outliers</a></li>
  <li><a href="#creation-of-additional-variables" id="toc-creation-of-additional-variables" class="nav-link" data-scroll-target="#creation-of-additional-variables">2.2.6 Creation of additional variables</a></li>
  <li><a href="#checking-of-frequency-distribution-and-skewness" id="toc-checking-of-frequency-distribution-and-skewness" class="nav-link" data-scroll-target="#checking-of-frequency-distribution-and-skewness">2.2.7 Checking of frequency distribution and skewness</a></li>
  <li><a href="#preview-pre-processed-dataframe" id="toc-preview-pre-processed-dataframe" class="nav-link" data-scroll-target="#preview-pre-processed-dataframe">2.2.8 Preview pre-processed dataframe</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#eda" id="toc-eda" class="nav-link" data-scroll-target="#eda">3. EDA</a>
  <ul class="collapse">
  <li><a href="#age-distribution-by-heart-attack-occurrence" id="toc-age-distribution-by-heart-attack-occurrence" class="nav-link" data-scroll-target="#age-distribution-by-heart-attack-occurrence">3.1 Age Distribution by Heart Attack Occurrence</a></li>
  <li><a href="#exploring-relationships-between-heart-attack-occurrence-by-age-group-and-heart-rate" id="toc-exploring-relationships-between-heart-attack-occurrence-by-age-group-and-heart-rate" class="nav-link" data-scroll-target="#exploring-relationships-between-heart-attack-occurrence-by-age-group-and-heart-rate">3.2 Exploring relationships between Heart Attack Occurrence, by Age Group and Heart Rate</a></li>
  <li><a href="#impact-of-historical-risk-factors-on-heart-attack-incidence-by-age-group" id="toc-impact-of-historical-risk-factors-on-heart-attack-incidence-by-age-group" class="nav-link" data-scroll-target="#impact-of-historical-risk-factors-on-heart-attack-incidence-by-age-group">3.3 Impact of Historical Risk Factors on Heart Attack Incidence by Age Group</a></li>
  <li><a href="#exploring-heart-attack-occurrence-by-demographic-and-lifestyle-factors" id="toc-exploring-heart-attack-occurrence-by-demographic-and-lifestyle-factors" class="nav-link" data-scroll-target="#exploring-heart-attack-occurrence-by-demographic-and-lifestyle-factors">3.1.4 Exploring Heart Attack Occurrence by demographic and lifestyle factors</a></li>
  <li><a href="#exploring-impact-of-risk-factors-on-heart-attack-occurence" id="toc-exploring-impact-of-risk-factors-on-heart-attack-occurence" class="nav-link" data-scroll-target="#exploring-impact-of-risk-factors-on-heart-attack-occurence">3.1.5 Exploring impact of risk factors on Heart Attack Occurence</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">3.1.6 Summary</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Take-home Excercise 1: Creating data visualization beyond default</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ou Yiming </p>
          </div>
  </div>
    
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">February 18, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="overview" class="level1">
<h1>1. Overview</h1>
<hr>
<section id="context" class="level2">
<h2 class="anchored" data-anchor-id="context"><strong>1.1 Context</strong></h2>
<p>This dataset contains information on heart attack cases in Japan, capturing various patient attributes such as age, gender, blood pressure, cholesterol levels, and other health indicators. Analyzing these factors can provide insights into key contributors to heart attacks and help identify high-risk groups.</p>
</section>
<section id="task" class="level2">
<h2 class="anchored" data-anchor-id="task">1.2 Task</h2>
<p>Using the dataset, this post aims to utilize appropriate Exploratory Data Analysis (EDA) techniques and <code>ggplot2</code> functions to:</p>
<ul>
<li><p>Examine the distribution of heart attack occurrences based on patient demographics and medical history, and</p></li>
<li><p>Investigate the relationships between heart attack incidence and factors such as age, gender, cholesterol levels, blood pressure, and other relevant health parameters.</p></li>
</ul>
</section>
</section>
<section id="getting-started" class="level1">
<h1>2. Getting Started</h1>
<hr>
<section id="load-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-packages">2.1 Load packages</h2>
<p>The following R packages will be loaded using the <code>p_load()</code> function for the analysis.</p>
<ul>
<li><p><strong>tidyverse</strong>: Core collection of R packages designed for data science.</p></li>
<li><p><strong>moments</strong>: Statistical package for calculating moments such as skewness and kurtosis.</p></li>
<li><p><strong>ggrepel</strong>: Provides geoms for <strong>ggplot2</strong> to repel overlapping text labels, making plots more readable.</p></li>
<li><p><strong>ggthemes</strong>: Provides additional themes for <strong>ggplot2</strong>, enhancing plot aesthetics.</p></li>
<li><p><strong>patchwork</strong>: A package for combining multiple <strong>ggplot2</strong> plots into a single layout, enabling the creation of complex and multi-panel visualizations.</p></li>
<li><p><strong>dplyr</strong>: A package for data manipulation, providing easy-to-use functions for transforming, summarizing, and filtering data.</p></li>
<li><p><strong>ggstatsplot</strong>: An extension of <strong>ggplot2</strong> that provides easy-to-use functions for visualizing statistical results, including p-values and confidence intervals.</p></li>
<li><p><strong>ggalluvial</strong>: A <strong>ggplot2</strong> extension for creating alluvial diagrams, useful for visualizing categorical data flows and relationships across multiple variables.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, moments, ggrepel, ggthemes,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               patchwork, dplyr, ggstatsplot, ggalluvial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="import-data" class="level2">
<h2 class="anchored" data-anchor-id="import-data">2.2 Import data</h2>
<p>The dataset (<code>japan_heart_attack_dataset.csv</code>) used in this exercise is sourced from the Kaggle project titled <strong>“Heart Attack in Japan (Youth vs Adult)”</strong> by Ashay Choudhary. This dataset provides information on heart attack cases in Japan, focusing on both youth and adult populations, and includes various health-related attributes such as age, cholesterol levels, blood pressure, and more.</p>
<p>The dataset will be imported as jha.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>jha <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/japan_heart_attack_dataset.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-pre-processing" class="level2">
<h2 class="anchored" data-anchor-id="data-pre-processing">2.2 Data pre-processing</h2>
<p>In this section, we will be focusing on the pre-proccessing of the data that we will be using for the analysis.</p>
<section id="glimpse-of-data" class="level3">
<h3 class="anchored" data-anchor-id="glimpse-of-data">2.2.1 Glimpse of Data</h3>
<p>Using the <code>glimpse</code> function, we can see that dataset contains 30,000 observations (rows) across 32 variables (columns). Each observation corresponds to a patient case from the heart attack dataset in Japan, and the variables provide information on various health indicators. The column names, column type, and the first few entries of each column can be observed below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(jha)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 30,000
Columns: 32
$ Age                     &lt;dbl&gt; 56, 69, 46, 32, 60, 25, 78, 38, 56, 75, 36, 40…
$ Gender                  &lt;chr&gt; "Male", "Male", "Male", "Female", "Female", "F…
$ Region                  &lt;chr&gt; "Urban", "Urban", "Rural", "Urban", "Rural", "…
$ Smoking_History         &lt;chr&gt; "Yes", "No", "Yes", "No", "No", "No", "No", "Y…
$ Diabetes_History        &lt;chr&gt; "No", "No", "No", "No", "No", "No", "Yes", "No…
$ Hypertension_History    &lt;chr&gt; "No", "No", "No", "No", "No", "No", "Yes", "No…
$ Cholesterol_Level       &lt;dbl&gt; 186.4002, 185.1367, 210.6966, 211.1655, 223.81…
$ Physical_Activity       &lt;chr&gt; "Moderate", "Low", "Low", "Moderate", "High", …
$ Diet_Quality            &lt;chr&gt; "Poor", "Good", "Average", "Good", "Good", "Go…
$ Alcohol_Consumption     &lt;chr&gt; "Low", "Low", "Moderate", "High", "High", "Hig…
$ Stress_Levels           &lt;dbl&gt; 3.644786, 3.384056, 3.810911, 6.014878, 6.8068…
$ BMI                     &lt;dbl&gt; 33.96135, 28.24287, 27.60121, 23.71729, 19.771…
$ Heart_Rate              &lt;dbl&gt; 72.30153, 57.45764, 64.65870, 55.13147, 76.667…
$ Systolic_BP             &lt;dbl&gt; 123.90209, 129.89331, 145.65490, 131.78522, 10…
$ Diastolic_BP            &lt;dbl&gt; 85.68281, 73.52426, 71.99481, 68.21133, 92.902…
$ Family_History          &lt;chr&gt; "No", "Yes", "No", "No", "No", "No", "No", "No…
$ Heart_Attack_Occurrence &lt;chr&gt; "No", "No", "No", "No", "No", "No", "No", "No"…
$ Extra_Column_1          &lt;dbl&gt; 0.40498852, 0.03627815, 0.85297888, 0.39085280…
$ Extra_Column_2          &lt;dbl&gt; 0.43330004, 0.51256694, 0.21959083, 0.29684675…
$ Extra_Column_3          &lt;dbl&gt; 0.62871236, 0.66839275, 0.61343656, 0.15572404…
$ Extra_Column_4          &lt;dbl&gt; 0.70160955, 0.11552874, 0.50800995, 0.87025144…
$ Extra_Column_5          &lt;dbl&gt; 0.49814235, 0.42381938, 0.90066981, 0.39035591…
$ Extra_Column_6          &lt;dbl&gt; 0.007901312, 0.083932768, 0.227205241, 0.40318…
$ Extra_Column_7          &lt;dbl&gt; 0.79458257, 0.68895108, 0.49634358, 0.74140891…
$ Extra_Column_8          &lt;dbl&gt; 0.29077922, 0.83016364, 0.75210679, 0.22396813…
$ Extra_Column_9          &lt;dbl&gt; 0.49719307, 0.63449028, 0.18150125, 0.32931387…
$ Extra_Column_10         &lt;dbl&gt; 0.52199452, 0.30204337, 0.62918031, 0.14319054…
$ Extra_Column_11         &lt;dbl&gt; 0.79965663, 0.04368285, 0.01827617, 0.90778075…
$ Extra_Column_12         &lt;dbl&gt; 0.72239788, 0.45166789, 0.06322702, 0.54232201…
$ Extra_Column_13         &lt;dbl&gt; 0.1487387, 0.8786714, 0.1465122, 0.9224606, 0.…
$ Extra_Column_14         &lt;dbl&gt; 0.8340099, 0.5356022, 0.9972962, 0.6262165, 0.…
$ Extra_Column_15         &lt;dbl&gt; 0.061632229, 0.617825340, 0.974455410, 0.22860…</code></pre>
</div>
</div>
</section>
<section id="removing-columns-with-no-description" class="level3">
<h3 class="anchored" data-anchor-id="removing-columns-with-no-description">2.2.2 Removing columns with no description</h3>
<p>Due to a lack of information on the additional columns, we will filter out the extra columns in our dataset as part of the pre-processing. Specifically, we will retain only columns 1 to 17 for our analysis.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>jha_clean <span class="ot">&lt;-</span> jha <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">17</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The following shows the unique values of each column to identify the amount variation in our variables.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(jha_clean, <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unique</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    Age                  Gender                  Region 
                     62                       2                       2 
        Smoking_History        Diabetes_History    Hypertension_History 
                      2                       2                       2 
      Cholesterol_Level       Physical_Activity            Diet_Quality 
                  30000                       3                       3 
    Alcohol_Consumption           Stress_Levels                     BMI 
                      4                   29613                   30000 
             Heart_Rate             Systolic_BP            Diastolic_BP 
                  30000                   30000                   30000 
         Family_History Heart_Attack_Occurrence 
                      2                       2 </code></pre>
</div>
</div>
<p>The following shows a summary of the cleaned dataset. Some of the numerical variables in the dataset contain questionable figures which will be dealt in a later step of pre-processing.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(jha_clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Age           Gender             Region          Smoking_History   
 Min.   :18.00   Length:30000       Length:30000       Length:30000      
 1st Qu.:33.00   Class :character   Class :character   Class :character  
 Median :48.00   Mode  :character   Mode  :character   Mode  :character  
 Mean   :48.49                                                           
 3rd Qu.:64.00                                                           
 Max.   :79.00                                                           
 Diabetes_History   Hypertension_History Cholesterol_Level Physical_Activity 
 Length:30000       Length:30000         Min.   : 80.02    Length:30000      
 Class :character   Class :character     1st Qu.:179.55    Class :character  
 Mode  :character   Mode  :character     Median :199.77    Mode  :character  
                                         Mean   :199.90                      
                                         3rd Qu.:220.16                      
                                         Max.   :336.86                      
 Diet_Quality       Alcohol_Consumption Stress_Levels         BMI       
 Length:30000       Length:30000        Min.   : 0.000   Min.   : 5.58  
 Class :character   Class :character    1st Qu.: 3.644   1st Qu.:21.63  
 Mode  :character   Mode  :character    Median : 4.993   Median :24.96  
                                        Mean   : 5.002   Mean   :25.00  
                                        3rd Qu.: 6.353   3rd Qu.:28.36  
                                        Max.   :10.000   Max.   :46.10  
   Heart_Rate      Systolic_BP      Diastolic_BP    Family_History    
 Min.   : 30.03   Min.   : 56.23   Min.   : 39.95   Length:30000      
 1st Qu.: 63.25   1st Qu.:109.79   1st Qu.: 73.26   Class :character  
 Median : 69.95   Median :119.90   Median : 80.12   Mode  :character  
 Mean   : 69.98   Mean   :119.91   Mean   : 80.03                     
 3rd Qu.: 76.66   3rd Qu.:130.02   3rd Qu.: 86.76                     
 Max.   :108.78   Max.   :178.77   Max.   :117.67                     
 Heart_Attack_Occurrence
 Length:30000           
 Class :character       
 Mode  :character       
                        
                        
                        </code></pre>
</div>
</div>
</section>
<section id="checking-for-duplicates-and-missing-values" class="level3">
<h3 class="anchored" data-anchor-id="checking-for-duplicates-and-missing-values">2.2.3 Checking for duplicates and missing values</h3>
<p>To ensure data quality, we will check for duplicate rows and missing values in the dataset as part of our pre-processing step. Removing duplicates and handling missing values helps maintain the integrity of our analysis.</p>
<p>We can see that there is no duplicate entries in the data.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>jha_clean[<span class="fu">duplicated</span>(jha_clean),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 17
# ℹ 17 variables: Age &lt;dbl&gt;, Gender &lt;chr&gt;, Region &lt;chr&gt;, Smoking_History &lt;chr&gt;,
#   Diabetes_History &lt;chr&gt;, Hypertension_History &lt;chr&gt;,
#   Cholesterol_Level &lt;dbl&gt;, Physical_Activity &lt;chr&gt;, Diet_Quality &lt;chr&gt;,
#   Alcohol_Consumption &lt;chr&gt;, Stress_Levels &lt;dbl&gt;, BMI &lt;dbl&gt;,
#   Heart_Rate &lt;dbl&gt;, Systolic_BP &lt;dbl&gt;, Diastolic_BP &lt;dbl&gt;,
#   Family_History &lt;chr&gt;, Heart_Attack_Occurrence &lt;chr&gt;</code></pre>
</div>
</div>
<p>We can also see that there is no missing values in the data.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(jha_clean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    Age                  Gender                  Region 
                      0                       0                       0 
        Smoking_History        Diabetes_History    Hypertension_History 
                      0                       0                       0 
      Cholesterol_Level       Physical_Activity            Diet_Quality 
                      0                       0                       0 
    Alcohol_Consumption           Stress_Levels                     BMI 
                      0                       0                       0 
             Heart_Rate             Systolic_BP            Diastolic_BP 
                      0                       0                       0 
         Family_History Heart_Attack_Occurrence 
                      0                       0 </code></pre>
</div>
</div>
</section>
<section id="checking-of-data-structure" class="level3">
<h3 class="anchored" data-anchor-id="checking-of-data-structure">2.2.4 Checking of data structure</h3>
<p>Using the <code>str()</code> function, we aim to understand the columns/variables being used in our analysis and the data structure they are casted as.</p>
<p>The primary columns/variables that are present in the dataset are as follow:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 47%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>Variable Name</th>
<th>Description</th>
<th>Type of Variable</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>Age</em></td>
<td>Age of the patient</td>
<td>Numerical Continuous</td>
</tr>
<tr class="even">
<td><em>Gender</em></td>
<td>Gender of the patient (Male/Female)</td>
<td>Categorical unordered</td>
</tr>
<tr class="odd">
<td><em>Region</em></td>
<td>Geographic region where the patient resides (Urban/Rural)</td>
<td>Categorical</td>
</tr>
<tr class="even">
<td><em>Smoking_History</em></td>
<td>Patient’s smoking history (Yes/No)</td>
<td>Categorical</td>
</tr>
<tr class="odd">
<td><em>Diabetes_History</em></td>
<td>History of diabetes (Yes/No)</td>
<td>Categorical</td>
</tr>
<tr class="even">
<td><em>Hypertension_History</em></td>
<td>History of hypertension (Yes/No)</td>
<td>Categorical</td>
</tr>
<tr class="odd">
<td><em>Cholesterol_Level</em></td>
<td>Cholesterol level of the patient</td>
<td>Numerical Continuous</td>
</tr>
<tr class="even">
<td><em>Physical_Activity</em></td>
<td>Level of physical activity (Low/Moderate/High)</td>
<td>Categorical</td>
</tr>
<tr class="odd">
<td><em>Diet_Quality</em></td>
<td>Quality of diet (Poor/Average/Good)</td>
<td>Categorical</td>
</tr>
<tr class="even">
<td><em>Alcohol_Consumption</em></td>
<td>Frequency of alcohol consumption (Yes/No)</td>
<td>Categorical</td>
</tr>
<tr class="odd">
<td><em>Stress_Levels</em></td>
<td>Patient’s stress levels (Low/Moderate/High)</td>
<td>Numerical Continuous</td>
</tr>
<tr class="even">
<td><em>BMI</em></td>
<td>Body Mass Index of the patient</td>
<td>Numerical Continuous</td>
</tr>
<tr class="odd">
<td><em>Heart_Rate</em></td>
<td>Resting heart rate of the patient</td>
<td>Numerical Continuous</td>
</tr>
<tr class="even">
<td><em>Systolic_BP</em></td>
<td>Systolic blood pressure</td>
<td>Numerical Continuous</td>
</tr>
<tr class="odd">
<td><em>Diastolic_BP</em></td>
<td>Diastolic blood pressure</td>
<td>Numerical Continuous</td>
</tr>
<tr class="even">
<td><em>Family_History</em></td>
<td>Family history of heart disease (Yes/No)</td>
<td>Categorical</td>
</tr>
<tr class="odd">
<td><em>Heart_Attack_Occurrence</em></td>
<td>Whether the patient had a heart attack (Yes/No)</td>
<td>Categorical (Target)</td>
</tr>
</tbody>
</table>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(jha_clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [30,000 × 17] (S3: tbl_df/tbl/data.frame)
 $ Age                    : num [1:30000] 56 69 46 32 60 25 78 38 56 75 ...
 $ Gender                 : chr [1:30000] "Male" "Male" "Male" "Female" ...
 $ Region                 : chr [1:30000] "Urban" "Urban" "Rural" "Urban" ...
 $ Smoking_History        : chr [1:30000] "Yes" "No" "Yes" "No" ...
 $ Diabetes_History       : chr [1:30000] "No" "No" "No" "No" ...
 $ Hypertension_History   : chr [1:30000] "No" "No" "No" "No" ...
 $ Cholesterol_Level      : num [1:30000] 186 185 211 211 224 ...
 $ Physical_Activity      : chr [1:30000] "Moderate" "Low" "Low" "Moderate" ...
 $ Diet_Quality           : chr [1:30000] "Poor" "Good" "Average" "Good" ...
 $ Alcohol_Consumption    : chr [1:30000] "Low" "Low" "Moderate" "High" ...
 $ Stress_Levels          : num [1:30000] 3.64 3.38 3.81 6.01 6.81 ...
 $ BMI                    : num [1:30000] 34 28.2 27.6 23.7 19.8 ...
 $ Heart_Rate             : num [1:30000] 72.3 57.5 64.7 55.1 76.7 ...
 $ Systolic_BP            : num [1:30000] 124 130 146 132 101 ...
 $ Diastolic_BP           : num [1:30000] 85.7 73.5 72 68.2 92.9 ...
 $ Family_History         : chr [1:30000] "No" "Yes" "No" "No" ...
 $ Heart_Attack_Occurrence: chr [1:30000] "No" "No" "No" "No" ...</code></pre>
</div>
</div>
<p>After inspection, the variables are casted as the right data types. Hence, no modification is required.</p>
</section>
<section id="removing-outliers" class="level3">
<h3 class="anchored" data-anchor-id="removing-outliers">2.2.5 Removing Outliers</h3>
<p>To detect outliers, we will use the Z-Score method, which calculates how many standard deviations each data point is from the mean. Any data point with a Z-Score greater than 3 or less than -3 is typically considered an outlier.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>continuous_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Age"</span>, <span class="st">"Cholesterol_Level"</span>, <span class="st">"Stress_Levels"</span>, <span class="st">"BMI"</span>, <span class="st">"Heart_Rate"</span>, <span class="st">"Systolic_BP"</span>, <span class="st">"Diastolic_BP"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate Z-Score and identify outliers</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>z_score_outliers <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  z_scores <span class="ot">&lt;-</span> (x <span class="sc">-</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> <span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">abs</span>(z_scores) <span class="sc">&gt;</span> <span class="dv">3</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(jha_clean[continuous_vars], z_score_outliers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              Age Cholesterol_Level     Stress_Levels               BMI 
                0                71                 0                80 
       Heart_Rate       Systolic_BP      Diastolic_BP 
               92                83                82 </code></pre>
</div>
</div>
<p>To ensure our dataset is free from extreme values that might skew the analysis, we will clean the outliers detected using the Z-Score method.</p>
<p>A maximum of 92 outliers were found in the numerical continuous variables of the dataset. As it is confirmed through further research that some of the values for these particular variables are out of the ordinary, a method suitable for dealing with these outliers was to remove them. Any observation with a Z-Score greater than 3 or less than -3 will be removed from the continuous numerical variables.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>remove_outliers <span class="ot">&lt;-</span> <span class="cf">function</span>(df, cols) {</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (col <span class="cf">in</span> cols) {</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    z_scores <span class="ot">&lt;-</span> (df[[col]] <span class="sc">-</span> <span class="fu">mean</span>(df[[col]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> <span class="fu">sd</span>(df[[col]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> df[<span class="fu">abs</span>(z_scores) <span class="sc">&lt;=</span> <span class="dv">3</span>, ]  <span class="co"># Keep rows within Z-Score range</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove outliers</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>jha_clean <span class="ot">&lt;-</span> <span class="fu">remove_outliers</span>(jha_clean, continuous_vars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>After removing the outliers, the dataset now contains <strong>29,596 observations</strong> and <strong>17 columns</strong>.</p>
</section>
<section id="creation-of-additional-variables" class="level3">
<h3 class="anchored" data-anchor-id="creation-of-additional-variables">2.2.6 Creation of additional variables</h3>
<p>To enhance the analysis, we will create new categorical variables by binning continuous variables such as age, cholesterol level, BMI, heart rate, systolic blood pressure, and diastolic blood pressure.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<div>
<p>Considerations when splitting the data:</p>
<ul>
<li><p>Having equal splits (to prevent skew)</p></li>
<li><p>Medically relevant categories for better interpretation</p></li>
</ul>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Binning Age into categories</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>jha_clean <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_Group =</span> <span class="fu">case_when</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    Age <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"Youth"</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    Age <span class="sc">&gt;=</span> <span class="dv">30</span> <span class="sc">&amp;</span> Age <span class="sc">&lt;</span> <span class="dv">50</span> <span class="sc">~</span> <span class="st">"Adult"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    Age <span class="sc">&gt;=</span> <span class="dv">50</span> <span class="sc">&amp;</span> Age <span class="sc">&lt;</span> <span class="dv">70</span> <span class="sc">~</span> <span class="st">"Middle-aged"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Elderly"</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Binning Cholesterol Level based on standard medical ranges</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>jha_clean <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cholesterol_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    Cholesterol_Level <span class="sc">&lt;</span> <span class="dv">200</span> <span class="sc">~</span> <span class="st">"Desirable"</span>,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    Cholesterol_Level <span class="sc">&gt;=</span> <span class="dv">200</span> <span class="sc">&amp;</span> Cholesterol_Level <span class="sc">&lt;</span> <span class="dv">240</span> <span class="sc">~</span> <span class="st">"Borderline High"</span>,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"High"</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Binning BMI based on WHO weight status categories</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>jha_clean <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BMI_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    BMI <span class="sc">&lt;</span> <span class="fl">18.5</span> <span class="sc">~</span> <span class="st">"Underweight"</span>,</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    BMI <span class="sc">&gt;=</span> <span class="fl">18.5</span> <span class="sc">&amp;</span> BMI <span class="sc">&lt;</span> <span class="fl">24.9</span> <span class="sc">~</span> <span class="st">"Normal weight"</span>,</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    BMI <span class="sc">&gt;=</span> <span class="dv">25</span> <span class="sc">&amp;</span> BMI <span class="sc">&lt;</span> <span class="fl">29.9</span> <span class="sc">~</span> <span class="st">"Overweight"</span>,</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Obese"</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Binning Heart Rate into categories</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>jha_clean <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Heart_Rate_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>    Heart_Rate <span class="sc">&lt;</span> <span class="dv">60</span> <span class="sc">~</span> <span class="st">"Below Normal"</span>,</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    Heart_Rate <span class="sc">&gt;=</span> <span class="dv">60</span> <span class="sc">&amp;</span> Heart_Rate <span class="sc">&lt;=</span> <span class="dv">100</span> <span class="sc">~</span> <span class="st">"Normal"</span>,</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Above Normal"</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Binning Systolic BP based on AHA guidelines</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>jha_clean <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Systolic_BP_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>    Systolic_BP <span class="sc">&lt;</span> <span class="dv">120</span> <span class="sc">~</span> <span class="st">"Normal"</span>,</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>    Systolic_BP <span class="sc">&gt;=</span> <span class="dv">120</span> <span class="sc">&amp;</span> Systolic_BP <span class="sc">&lt;</span> <span class="dv">130</span> <span class="sc">~</span> <span class="st">"Elevated"</span>,</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>    Systolic_BP <span class="sc">&gt;=</span> <span class="dv">130</span> <span class="sc">&amp;</span> Systolic_BP <span class="sc">&lt;</span> <span class="dv">140</span> <span class="sc">~</span> <span class="st">"Hypertension Stage 1"</span>,</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>    Systolic_BP <span class="sc">&gt;=</span> <span class="dv">140</span> <span class="sc">~</span> <span class="st">"Hypertension Stage 2"</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Binning Diastolic BP based on AHA guidelines</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>jha_clean <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Diastolic_BP_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>    Diastolic_BP <span class="sc">&lt;</span> <span class="dv">80</span> <span class="sc">~</span> <span class="st">"Normal"</span>,</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>    Diastolic_BP <span class="sc">&gt;=</span> <span class="dv">80</span> <span class="sc">&amp;</span> Diastolic_BP <span class="sc">&lt;</span> <span class="dv">90</span> <span class="sc">~</span> <span class="st">"Hypertension Stage 1"</span>,</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Hypertension Stage 2"</span></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="checking-of-frequency-distribution-and-skewness" class="level3">
<h3 class="anchored" data-anchor-id="checking-of-frequency-distribution-and-skewness">2.2.7 Checking of frequency distribution and skewness</h3>
<p>To ensure balanced data for modeling, we will check all categorical variables for class imbalances.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Output</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>cat_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"Region"</span>, <span class="st">"Smoking_History"</span>, <span class="st">"Diabetes_History"</span>, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Hypertension_History"</span>, <span class="st">"Physical_Activity"</span>, <span class="st">"Diet_Quality"</span>, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Alcohol_Consumption"</span>, <span class="st">"Stress_Levels"</span>, <span class="st">"Family_History"</span>, </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Heart_Attack_Occurrence"</span>, <span class="st">"Age_Group"</span>, <span class="st">"Cholesterol_Category"</span>, </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">"BMI_Category"</span>, <span class="st">"Heart_Rate_Category"</span>, <span class="st">"Systolic_BP_Category"</span>, <span class="st">"Diastolic_BP_Category"</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> cat_vars) {</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, var, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">table</span>(jha_clean[[var]]))</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
 Gender 

Female   Male 
 14736  14860 

 Region 

Rural Urban 
 8821 20775 

 Smoking_History 

   No   Yes 
20705  8891 

 Diabetes_History 

   No   Yes 
23584  6012 

 Hypertension_History 

   No   Yes 
22265  7331 

 Physical_Activity 

    High      Low Moderate 
    8963     8861    11772 

 Diet_Quality 

Average    Good    Poor 
  11807   11830    5959 

 Alcohol_Consumption 

    High      Low Moderate     None 
    5738     8970    11909     2979 

 Family_History 

   No   Yes 
20792  8804 

 Heart_Attack_Occurrence 

   No   Yes 
26675  2921 

 Age_Group 

      Adult     Elderly Middle-aged       Youth 
       9736        4810        9442        5608 

 Cholesterol_Category 

Borderline High       Desirable            High 
          12056           14872            2668 

 BMI_Category 

Normal weight         Obese    Overweight   Underweight 
        11859          5060          9874          2803 

 Heart_Rate_Category 

Below Normal       Normal 
        4551        25045 

 Systolic_BP_Category 

            Elevated Hypertension Stage 1 Hypertension Stage 2 
                7326                 4711                 2696 
              Normal 
               14863 

 Diastolic_BP_Category 

Hypertension Stage 1 Hypertension Stage 2               Normal 
               10266                 4636                14694 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Next, we will also check for skewness in the continuous variables. Skewness indicates asymmetry in the data distribution, which can affect model predictions. Data with high skewness might require transformation for better model performance.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Output</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>continuous_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Age"</span>, <span class="st">"Cholesterol_Level"</span>, <span class="st">"BMI"</span>, <span class="st">"Heart_Rate"</span>, <span class="st">"Systolic_BP"</span>, <span class="st">"Diastolic_BP"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(jha_clean[continuous_vars], skewness)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>              Age Cholesterol_Level               BMI        Heart_Rate 
      0.010188319       0.004952816       0.011360070       0.007628102 
      Systolic_BP      Diastolic_BP 
     -0.022631811      -0.005712073 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The skewness values are all close to 0, indicating that the continuous variables are approximately normally distributed. Since there is no significant skewness, no transformations are necessary for these variables before model training.</p>
</section>
<section id="preview-pre-processed-dataframe" class="level3">
<h3 class="anchored" data-anchor-id="preview-pre-processed-dataframe">2.2.8 Preview pre-processed dataframe</h3>
<p>Using <code>str()</code>, we can observe that our pre-processed dataset now consists of <strong>29,596 observations</strong> and <strong>23 columns</strong>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(jha_clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [29,596 × 23] (S3: tbl_df/tbl/data.frame)
 $ Age                    : num [1:29596] 56 69 46 32 60 25 78 38 56 75 ...
 $ Gender                 : chr [1:29596] "Male" "Male" "Male" "Female" ...
 $ Region                 : chr [1:29596] "Urban" "Urban" "Rural" "Urban" ...
 $ Smoking_History        : chr [1:29596] "Yes" "No" "Yes" "No" ...
 $ Diabetes_History       : chr [1:29596] "No" "No" "No" "No" ...
 $ Hypertension_History   : chr [1:29596] "No" "No" "No" "No" ...
 $ Cholesterol_Level      : num [1:29596] 186 185 211 211 224 ...
 $ Physical_Activity      : chr [1:29596] "Moderate" "Low" "Low" "Moderate" ...
 $ Diet_Quality           : chr [1:29596] "Poor" "Good" "Average" "Good" ...
 $ Alcohol_Consumption    : chr [1:29596] "Low" "Low" "Moderate" "High" ...
 $ Stress_Levels          : num [1:29596] 3.64 3.38 3.81 6.01 6.81 ...
 $ BMI                    : num [1:29596] 34 28.2 27.6 23.7 19.8 ...
 $ Heart_Rate             : num [1:29596] 72.3 57.5 64.7 55.1 76.7 ...
 $ Systolic_BP            : num [1:29596] 124 130 146 132 101 ...
 $ Diastolic_BP           : num [1:29596] 85.7 73.5 72 68.2 92.9 ...
 $ Family_History         : chr [1:29596] "No" "Yes" "No" "No" ...
 $ Heart_Attack_Occurrence: chr [1:29596] "No" "No" "No" "No" ...
 $ Age_Group              : chr [1:29596] "Middle-aged" "Middle-aged" "Adult" "Adult" ...
 $ Cholesterol_Category   : chr [1:29596] "Desirable" "Desirable" "Borderline High" "Borderline High" ...
 $ BMI_Category           : chr [1:29596] "Obese" "Overweight" "Overweight" "Normal weight" ...
 $ Heart_Rate_Category    : chr [1:29596] "Normal" "Below Normal" "Normal" "Below Normal" ...
 $ Systolic_BP_Category   : chr [1:29596] "Elevated" "Elevated" "Hypertension Stage 2" "Hypertension Stage 1" ...
 $ Diastolic_BP_Category  : chr [1:29596] "Hypertension Stage 1" "Normal" "Normal" "Normal" ...</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="eda" class="level1">
<h1>3. EDA</h1>
<hr>
<section id="age-distribution-by-heart-attack-occurrence" class="level2">
<h2 class="anchored" data-anchor-id="age-distribution-by-heart-attack-occurrence">3.1 Age Distribution by Heart Attack Occurrence</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>jha_clean<span class="sc">$</span>Heart_Attack_Occurrence <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(jha_clean<span class="sc">$</span>Heart_Attack_Occurrence)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>violin_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(jha_clean, <span class="fu">aes</span>(<span class="at">x =</span> Heart_Attack_Occurrence, <span class="at">y =</span> Age, <span class="at">fill =</span> Heart_Attack_Occurrence)) <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">scale =</span> <span class="st">"area"</span>) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>), <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>median, <span class="at">geom=</span><span class="st">"point"</span>, <span class="at">shape=</span><span class="dv">18</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>median, <span class="at">geom=</span><span class="st">"text"</span>, <span class="fu">aes</span>(<span class="at">label=</span><span class="fu">round</span>(..y..,<span class="dv">1</span>)), <span class="at">vjust=</span><span class="sc">-</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heart Attack Occurrence by Age Distribution"</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Heart Attack Occurrence"</span>, <span class="at">y =</span> <span class="st">"Age"</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Violin plot with boxplot overlay and Bar plot"</span>) <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>bar_plot <span class="ot">&lt;-</span> <span class="fu">ggbarstats</span>(jha_clean, </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">x =</span> Age_Group, </span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> Heart_Attack_Occurrence)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>violin_plot <span class="sc">+</span> bar_plot <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insight
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Patients who experienced heart attacks (<strong>49 years</strong>) tend to be slightly older, with a median age higher than that of patients without heart attacks (<strong>48 years</strong>).</p></li>
<li><p>Both groups cover a similar age range, but the <strong>density is higher in the adult and elderly brackets for heart attack cases</strong>, suggesting a strong association between age and heart attack occurrence.</p></li>
<li><p>To further confirm the observation that there is a strong association between age and heart attack occurence, a significant test of association was performed on the right. However, given the Cramer’s V value (0.01), there seems to be a <strong>weak association</strong> between age group and heart attack occurrence.</p></li>
</ul>
</div>
</div>
</section>
<section id="exploring-relationships-between-heart-attack-occurrence-by-age-group-and-heart-rate" class="level2">
<h2 class="anchored" data-anchor-id="exploring-relationships-between-heart-attack-occurrence-by-age-group-and-heart-rate">3.2 Exploring relationships between Heart Attack Occurrence, by Age Group and Heart Rate</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure Age_Group are in order</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>jha_clean<span class="sc">$</span>Age_Group <span class="ot">&lt;-</span> <span class="fu">factor</span>(jha_clean<span class="sc">$</span>Age_Group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Youth"</span>, <span class="st">"Adult"</span>, <span class="st">"Middle-aged"</span>, <span class="st">"Elderly"</span>))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the faceted density plot</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>heart_rate_density <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> jha_clean, <span class="fu">aes</span>(<span class="at">x =</span> Heart_Rate, <span class="at">fill =</span> Heart_Attack_Occurrence)) <span class="sc">+</span>    </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Age_Group, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">nrow =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Heart Rate"</span>, <span class="at">y =</span> <span class="st">"Density"</span>, <span class="at">title =</span> <span class="st">"Heart Rate Distribution Across Age Groups"</span>, </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Density and Box plot of Heart Rate, colored by Heart Attack Occurrence"</span>) <span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>), </span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>), </span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>), </span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the boxplot</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>heart_rate_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(jha_clean, <span class="fu">aes</span>(<span class="at">x =</span> Age_Group, <span class="at">y =</span> Heart_Rate, <span class="at">fill =</span> Heart_Attack_Occurrence)) <span class="sc">+</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> median, <span class="at">geom =</span> <span class="st">"text"</span>,<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">round</span>(..y..,<span class="dv">1</span>)), <span class="at">vjust=</span><span class="sc">-</span><span class="fl">1.0</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(jha_clean<span class="sc">$</span>Heart_Rate), <span class="fu">max</span>(jha_clean<span class="sc">$</span>Heart_Rate))) <span class="sc">+</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Heart Rate"</span>) <span class="sc">+</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">8</span>), </span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>), <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots with adjusted layout</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>heart_rate_density <span class="sc">+</span> heart_rate_boxplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insight
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Across all age groups, patients who experienced heart attacks tend to have <strong>slightly higher median heart rates</strong> compared to those who did not.</p></li>
<li><p>In the Elderly group, the heart rates for patients with heart attacks are <strong>more concentrated towards the higher end</strong> of the scale.</p></li>
<li><p>The Youth group show <strong>a broader sprea</strong>d of heart rates, with less distinction between patients with and without heart attacks.</p></li>
<li><p>Higher heart rates, especially in older age groups, might indicate an association with increased heart attack risk, though younger patients show less variation.</p></li>
</ul>
</div>
</div>
</section>
<section id="impact-of-historical-risk-factors-on-heart-attack-incidence-by-age-group" class="level2">
<h2 class="anchored" data-anchor-id="impact-of-historical-risk-factors-on-heart-attack-incidence-by-age-group">3.3 Impact of Historical Risk Factors on Heart Attack Incidence by Age Group</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Output</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate heart attack percentages for each risk factor across age groups</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>risk_factors_summary <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_Group) <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Smoking =</span> <span class="fu">mean</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> Smoking_History <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Diabetes =</span> <span class="fu">mean</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> Diabetes_History <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Hypertension =</span> <span class="fu">mean</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> Hypertension_History <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Family_History =</span> <span class="fu">mean</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> Family_History <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to long format for plotting</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(Smoking, Diabetes, Hypertension, Family_History),</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Risk_Factor"</span>,</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Heart_Attack_Percentage"</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the visualization</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(risk_factors_summary, </span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Age_Group, </span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> Heart_Attack_Percentage, </span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> Risk_Factor)) <span class="sc">+</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="st">"dodge"</span>,</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Heart_Attack_Percentage)),</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>),</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Smoking"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>, </span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Diabetes"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>,</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Hypertension"</span> <span class="ot">=</span> <span class="st">"#009E73"</span>,</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Family_History"</span> <span class="ot">=</span> <span class="st">"#CC79A7"</span>)) <span class="sc">+</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heart Attack Occurrence by Risk Factors Across Age Groups"</span>,</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Percentage of heart attacks in patients with each risk factor"</span>,</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Group"</span>,</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage of Heart Attacks (%)"</span>) <span class="sc">+</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insight
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>All risk factors maintain relatively <strong>consistent levels</strong> across age groups (2.0-3.2% range)</p></li>
<li><p><strong>Family History</strong> seems to contribute to a higher risk of heart attack occurrence across age group after youth.</p></li>
<li><p><strong>Smoking</strong> consistently presents the highest risk across all age groups.</p></li>
<li><p>Surprisingly, younger age groups show <strong>comparable risk levels</strong> to older groups.</p></li>
<li><p>The combination of multiple risk factors might compound the risk, though this isn’t shown in the visualization.</p></li>
<li><p>No dramatic age-related increases in risk for any single factor, suggesting these are <strong>relatively independent risk factors</strong>.</p></li>
</ul>
</div>
</div>
</section>
<section id="exploring-heart-attack-occurrence-by-demographic-and-lifestyle-factors" class="level2">
<h2 class="anchored" data-anchor-id="exploring-heart-attack-occurrence-by-demographic-and-lifestyle-factors">3.1.4 Exploring Heart Attack Occurrence by demographic and lifestyle factors</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Output</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># Prepare data focusing on Heart Attack Occurrence = "Yes" by demographic and lifestyle factors</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>heart_attack_focus <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Gender, Region, Physical_Activity, Diet_Quality, Alcohol_Consumption, Heart_Attack_Occurrence) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Gender, Region, Physical_Activity, Diet_Quality, Alcohol_Consumption, Heart_Attack_Occurrence) <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create parallel sets visualization focusing on heart attack occurrences for "Yes"</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heart_attack_focus,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">axis1 =</span> Gender, </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis2 =</span> Region,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis3 =</span> Physical_Activity,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis4 =</span> Diet_Quality,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis5 =</span> Alcohol_Consumption,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_alluvium</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Heart_Attack_Occurrence), <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_stratum</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Heart_Attack_Occurrence), <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"stratum"</span>,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(stratum)), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"#4682B4"</span>)) <span class="sc">+</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"Region"</span>, <span class="st">"Physical_Activity"</span>, <span class="st">"Diet_Quality"</span>, <span class="st">"Alcohol_Consumption"</span>),</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"Region"</span>, <span class="st">"Physical Activity"</span>, <span class="st">"Diet Quality"</span>, <span class="st">"Alcohol Consumption"</span>)) <span class="sc">+</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heart Attack Occurrence Distribution"</span>,</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Relation between Demographic and Lifestyle Factors to Heart Attack Occurrence"</span>,</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Demographic and Lifestyle Factors"</span>,</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Heart Attack Occurrence"</span>) <span class="sc">+</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data focusing on Heart Attack Occurrence = "No" by demographic and lifestyle factors</span></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>no_heart_attack_focus <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"No"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Gender, Region, Physical_Activity, Diet_Quality, Alcohol_Consumption, Heart_Attack_Occurrence) <span class="sc">%&gt;%</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Gender, Region, Physical_Activity, Diet_Quality, Alcohol_Consumption, Heart_Attack_Occurrence) <span class="sc">%&gt;%</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the parallel sets visualization focusing on "No" heart attack occurrences</span></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(no_heart_attack_focus,</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">axis1 =</span> Gender, </span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis2 =</span> Region,</span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis3 =</span> Physical_Activity,</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis4 =</span> Diet_Quality,</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis5 =</span> Alcohol_Consumption,</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_alluvium</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Heart_Attack_Occurrence), <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_stratum</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Heart_Attack_Occurrence), <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"stratum"</span>,</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(stratum)), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"#D32F2F"</span>)) <span class="sc">+</span></span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"Region"</span>, <span class="st">"Physical_Activity"</span>, <span class="st">"Diet_Quality"</span>, <span class="st">"Alcohol_Consumption"</span>),</span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"Region"</span>, <span class="st">"Physical Activity"</span>, <span class="st">"Diet Quality"</span>, <span class="st">"Alcohol Consumption"</span>)) <span class="sc">+</span></span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heart Attack Occurrence Distribution"</span>,</span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Relation between Demographic and Lifestyle Factors to Heart Attack Occurrence"</span>,</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Demographic and Lifestyle Factors"</span>,</span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Heart Attack Occurrence"</span>) <span class="sc">+</span></span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insight
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>There is a higher percentage of indivuals that experience heart attack coming from <strong>urban regions</strong> regardless of gender.</p></li>
<li><p><strong>Moderate physical activity</strong> is common among those with heart attacks.</p></li>
<li><p><strong>Good and Average</strong> <strong>diet</strong> appears to be linked to a higher occurrence of heart attacks.</p></li>
<li><p><strong>Moderate and low alcohol consumption</strong> shows the most notable presence in the heart attack group.</p></li>
<li><p><strong>General Insight</strong>: Although the plot emphasizes the impact of <strong>lifestyle factors</strong> like <strong>physical activity</strong>, <strong>diet</strong>, and <strong>alcohol consumption</strong> on heart attack occurrence, it simply depicts the observations of these factors in the group of people with heart attack occurrence.</p></li>
<li><p><strong>Further Investigation:</strong> Upon further comparison with the group with no heart attack occurrence, it seems to exhibit a similar pattern to the group with hear attack occurrence. <strong>Statistical studies</strong> have to be performed to confirm if the pattern is more significant in one group than the other.</p></li>
</ul>
</div>
</div>
</section>
<section id="exploring-impact-of-risk-factors-on-heart-attack-occurence" class="level2">
<h2 class="anchored" data-anchor-id="exploring-impact-of-risk-factors-on-heart-attack-occurence">3.1.5 Exploring impact of risk factors on Heart Attack Occurence</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create binary risk factor columns (TRUE if risk factor present, FALSE otherwise)</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>jha_clean_filtered <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">smoking_risk =</span> <span class="fu">ifelse</span>(Smoking_History <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">diabetes_risk =</span> <span class="fu">ifelse</span>(Diabetes_History <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">hypertension_risk =</span> <span class="fu">ifelse</span>(Hypertension_History <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cholesterol_risk =</span> <span class="fu">ifelse</span>(Cholesterol_Category <span class="sc">==</span> <span class="st">"High"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_risk =</span> <span class="fu">ifelse</span>(BMI_Category <span class="sc">==</span> <span class="st">"Obese"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">bp_risk =</span> <span class="fu">ifelse</span>(Systolic_BP_Category <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Hypertension Stage 1"</span>, <span class="st">"Hypertension Stage 2"</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">heart_rate_risk =</span> <span class="fu">ifelse</span>(Heart_Rate_Category <span class="sc">==</span> <span class="st">"Above Normal"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the total number of risk factors for each individual</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>jha_clean_filtered <span class="ot">&lt;-</span> jha_clean_filtered <span class="sc">%&gt;%</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">risk_level =</span> smoking_risk <span class="sc">+</span> diabetes_risk <span class="sc">+</span> hypertension_risk <span class="sc">+</span> cholesterol_risk <span class="sc">+</span> bmi_risk <span class="sc">+</span> bp_risk <span class="sc">+</span> heart_rate_risk)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the number of individuals with each risk level (from 0 to 8 risk factors)</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>risk_summary <span class="ot">&lt;-</span> jha_clean_filtered <span class="sc">%&gt;%</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(risk_level) <span class="sc">%&gt;%</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_patients =</span> <span class="fu">n</span>(),</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">heart_attacks =</span> <span class="fu">sum</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>),</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">risk_percentage =</span> (heart_attacks <span class="sc">/</span> total_patients) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">risk_label =</span> <span class="fu">paste</span>(risk_level, <span class="st">"Risk Factors"</span>))</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage of the population with each risk level</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>total_population <span class="ot">&lt;-</span> <span class="fu">nrow</span>(jha_clean_filtered)</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>risk_summary <span class="ot">&lt;-</span> risk_summary <span class="sc">%&gt;%</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">population_percentage =</span> (total_patients <span class="sc">/</span> total_population) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(risk_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 6
  risk_level total_patients heart_attacks risk_percentage risk_label    
       &lt;dbl&gt;          &lt;int&gt;         &lt;int&gt;           &lt;dbl&gt; &lt;chr&gt;         
1          0           6951           690            9.93 0 Risk Factors
2          1          11677          1135            9.72 1 Risk Factors
3          2           7809           779            9.98 2 Risk Factors
4          3           2615           260            9.94 3 Risk Factors
5          4            493            53           10.8  4 Risk Factors
6          5             49             4            8.16 5 Risk Factors
7          6              2             0            0    6 Risk Factors
# ℹ 1 more variable: population_percentage &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Output</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(risk_summary, </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> risk_level, <span class="at">y =</span> risk_percentage)) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"#2C7BB6"</span>) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> total_patients), </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#2C7BB6"</span>, </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, risk_percentage)),</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"n ="</span>, total_patients)),</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">2</span>, </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1 Risk Factor"</span>, <span class="st">"2 Risk Factors"</span>, <span class="st">"3 Risk Factors"</span>, <span class="st">"4 Risk Factors"</span>, <span class="st">"5 Risk Factors"</span>, <span class="st">"6 Risk Factors"</span>)) <span class="sc">+</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Impact of Risk Factors on Heart Attack Occurrence"</span>,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Percentage of heart attacks increases as more risk factors accumulate"</span>,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Accumulated Risk Factors"</span>,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Heart Attack Occurrence (%)"</span>) <span class="sc">+</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insight
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The percentage of heart attacks remains relatively stable (around 9.9%) for individuals with <strong>1 to 3 risk factors</strong>, indicating that a few risk factors don’t dramatically increase heart attack occurrence.</li>
<li>With <strong>4 to 5 risk factors</strong>, the heart attack occurrence percentage rises slightly to 10.0% and 10.6%, showing a modest increase in risk.</li>
<li>At <strong>6 risk factors</strong>, the heart attack occurrence drops sharply to 0%, likely due to a very small sample size (only 49 individuals), suggesting unreliable data for this group.</li>
<li>Larger sample sizes at 1 to 3 risk factors ensure more reliable results, while smaller sample sizes at higher risk levels lead to potential inconsistencies.</li>
<li>The overall trend indicates that heart attack risk <strong>increases slightly with the accumulation of risk factors</strong> up to 5.</li>
</ul>
</div>
</div>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">3.1.6 Summary</h2>
<section id="conclusion" class="level4">
<h4 class="anchored" data-anchor-id="conclusion">3.1.6.1 Conclusion</h4>
<ul>
<li><strong>Age and Heart Attack:</strong> Adult and Middle-Age patients tend to have higher heart attack occurrences, but the weak association with age suggests that further analysis is needed to better understand its impact.</li>
<li><strong>Heart Rate and Risk:</strong> Patients with heart attacks show slightly higher heart rates, especially in older age groups. While there is a trend, more analysis is required to confirm its significance.</li>
<li><strong>Risk Factors:</strong> Smoking is the most consistent risk factor across age groups, while family history increases risk in older individuals. Risk factors appear to act independently.</li>
<li><strong>Lifestyle Factors:</strong> Physical activity, diet, and alcohol consumption are linked to heart attack occurrence, but similar patterns are seen in both heart attack and non-heart attack groups.</li>
<li><strong>Accumulated Risk:</strong> Heart attack occurrence increases slightly with the accumulation of 1 to 5 risk factors. However, due to small sample sizes at higher risk levels, further modeling and collection of data for risk levels 6 and above are required for more reliable insights.</li>
</ul>
</section>
<section id="future-work" class="level4">
<h4 class="anchored" data-anchor-id="future-work">3.1.6.2 Future Work</h4>
<p>While the visualizations provide useful observations, further statistical analyses and modeling techniques (e.g., logistic regression, decision trees) are essential to better explain the true impact of individual and combined variables on heart attack occurrence. These models can help quantify the relative contribution of each variable, determine interactions between risk factors and potentially identify new insights that can inform preventive measures and interventions for heart attacks.</p>
</section>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<ul>
<li>Prof Kam Tin Seong (2025) https://r4va.netlify.app/. Online version.</li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb33" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Take-home Excercise 1: Creating data visualization beyond default"</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Ou Yiming"</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> "last-modified"</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="co">  eval: true</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co">  freeze: true</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="fu"># 1. Overview</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="fu">## **1.1 Context**</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>This dataset contains information on heart attack cases in Japan, capturing various patient attributes such as age, gender, blood pressure, cholesterol levels, and other health indicators. Analyzing these factors can provide insights into key contributors to heart attacks and help identify high-risk groups.</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.2 Task</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>Using the dataset, this post aims to utilize appropriate Exploratory Data Analysis (EDA) techniques and <span class="in">`ggplot2`</span> functions to:</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Examine the distribution of heart attack occurrences based on patient demographics and medical history, and</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Investigate the relationships between heart attack incidence and factors such as age, gender, cholesterol levels, blood pressure, and other relevant health parameters.</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a><span class="fu"># 2. Getting Started</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2.1 Load packages</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>The following R packages will be loaded using the <span class="in">`p_load()`</span> function for the analysis.</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**tidyverse**: Core collection of R packages designed for data science.</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**moments**: Statistical package for calculating moments such as skewness and kurtosis.</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**ggrepel**: Provides geoms for **ggplot2** to repel overlapping text labels, making plots more readable.</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**ggthemes**: Provides additional themes for **ggplot2**, enhancing plot aesthetics.</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**patchwork**: A package for combining multiple **ggplot2** plots into a single layout, enabling the creation of complex and multi-panel visualizations.</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**dplyr**: A package for data manipulation, providing easy-to-use functions for transforming, summarizing, and filtering data.</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**ggstatsplot**: An extension of **ggplot2** that provides easy-to-use functions for visualizing statistical results, including p-values and confidence intervals.</span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**ggalluvial**: A **ggplot2** extension for creating alluvial diagrams, useful for visualizing categorical data flows and relationships across multiple variables.</span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, moments, ggrepel, ggthemes,</span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>               patchwork, dplyr, ggstatsplot, ggalluvial)</span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2.2 Import data</span></span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>The dataset (<span class="in">`japan_heart_attack_dataset.csv`</span>) used in this exercise is sourced from the Kaggle project titled **"Heart Attack in Japan (Youth vs Adult)"** by Ashay Choudhary. This dataset provides information on heart attack cases in Japan, focusing on both youth and adult populations, and includes various health-related attributes such as age, cholesterol levels, blood pressure, and more.</span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>The dataset will be imported as jha.</span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true" tabindex="-1"></a>jha <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/japan_heart_attack_dataset.csv"</span>)</span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2.2 Data pre-processing</span></span>
<span id="cb33-77"><a href="#cb33-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-78"><a href="#cb33-78" aria-hidden="true" tabindex="-1"></a>In this section, we will be focusing on the pre-proccessing of the data that we will be using for the analysis.</span>
<span id="cb33-79"><a href="#cb33-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-80"><a href="#cb33-80" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.2.1 Glimpse of Data</span></span>
<span id="cb33-81"><a href="#cb33-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-82"><a href="#cb33-82" aria-hidden="true" tabindex="-1"></a>Using the <span class="in">`glimpse`</span> function, we can see that dataset contains 30,000 observations (rows) across 32 variables (columns). Each observation corresponds to a patient case from the heart attack dataset in Japan, and the variables provide information on various health indicators. The column names, column type, and the first few entries of each column can be observed below.</span>
<span id="cb33-83"><a href="#cb33-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-86"><a href="#cb33-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-87"><a href="#cb33-87" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(jha)</span>
<span id="cb33-88"><a href="#cb33-88" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-89"><a href="#cb33-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-90"><a href="#cb33-90" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.2.2 Removing columns with no description</span></span>
<span id="cb33-91"><a href="#cb33-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-92"><a href="#cb33-92" aria-hidden="true" tabindex="-1"></a>Due to a lack of information on the additional columns, we will filter out the extra columns in our dataset as part of the pre-processing. Specifically, we will retain only columns 1 to 17 for our analysis.</span>
<span id="cb33-93"><a href="#cb33-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-96"><a href="#cb33-96" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-97"><a href="#cb33-97" aria-hidden="true" tabindex="-1"></a>jha_clean <span class="ot">&lt;-</span> jha <span class="sc">%&gt;%</span></span>
<span id="cb33-98"><a href="#cb33-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">17</span>)</span>
<span id="cb33-99"><a href="#cb33-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-100"><a href="#cb33-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-101"><a href="#cb33-101" aria-hidden="true" tabindex="-1"></a>The following shows the unique values of each column to identify the amount variation in our variables.</span>
<span id="cb33-102"><a href="#cb33-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-105"><a href="#cb33-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-106"><a href="#cb33-106" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(jha_clean, <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unique</span>(x)))</span>
<span id="cb33-107"><a href="#cb33-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-108"><a href="#cb33-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-109"><a href="#cb33-109" aria-hidden="true" tabindex="-1"></a>The following shows a summary of the cleaned dataset. Some of the numerical variables in the dataset contain questionable figures which will be dealt in a later step of pre-processing.</span>
<span id="cb33-110"><a href="#cb33-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-113"><a href="#cb33-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-114"><a href="#cb33-114" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(jha_clean)</span>
<span id="cb33-115"><a href="#cb33-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-116"><a href="#cb33-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-117"><a href="#cb33-117" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.2.3 Checking for duplicates and missing values</span></span>
<span id="cb33-118"><a href="#cb33-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-119"><a href="#cb33-119" aria-hidden="true" tabindex="-1"></a>To ensure data quality, we will check for duplicate rows and missing values in the dataset as part of our pre-processing step. Removing duplicates and handling missing values helps maintain the integrity of our analysis.</span>
<span id="cb33-120"><a href="#cb33-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-121"><a href="#cb33-121" aria-hidden="true" tabindex="-1"></a>We can see that there is no duplicate entries in the data.</span>
<span id="cb33-122"><a href="#cb33-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-125"><a href="#cb33-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-126"><a href="#cb33-126" aria-hidden="true" tabindex="-1"></a>jha_clean[<span class="fu">duplicated</span>(jha_clean),]</span>
<span id="cb33-127"><a href="#cb33-127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-128"><a href="#cb33-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-129"><a href="#cb33-129" aria-hidden="true" tabindex="-1"></a>We can also see that there is no missing values in the data.</span>
<span id="cb33-130"><a href="#cb33-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-133"><a href="#cb33-133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-134"><a href="#cb33-134" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(jha_clean))</span>
<span id="cb33-135"><a href="#cb33-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-136"><a href="#cb33-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-137"><a href="#cb33-137" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.2.4 Checking of data structure</span></span>
<span id="cb33-138"><a href="#cb33-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-139"><a href="#cb33-139" aria-hidden="true" tabindex="-1"></a>Using the <span class="in">`str()`</span> function, we aim to understand the columns/variables being used in our analysis and the data structure they are casted as.</span>
<span id="cb33-140"><a href="#cb33-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-141"><a href="#cb33-141" aria-hidden="true" tabindex="-1"></a>The primary columns/variables that are present in the dataset are as follow:</span>
<span id="cb33-142"><a href="#cb33-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-143"><a href="#cb33-143" aria-hidden="true" tabindex="-1"></a>| Variable Name | Description | Type of Variable |</span>
<span id="cb33-144"><a href="#cb33-144" aria-hidden="true" tabindex="-1"></a>|-------------------|----------------------------------|-------------------|</span>
<span id="cb33-145"><a href="#cb33-145" aria-hidden="true" tabindex="-1"></a>| *Age* | Age of the patient | Numerical Continuous |</span>
<span id="cb33-146"><a href="#cb33-146" aria-hidden="true" tabindex="-1"></a>| *Gender* | Gender of the patient (Male/Female) | Categorical unordered |</span>
<span id="cb33-147"><a href="#cb33-147" aria-hidden="true" tabindex="-1"></a>| *Region* | Geographic region where the patient resides (Urban/Rural) | Categorical |</span>
<span id="cb33-148"><a href="#cb33-148" aria-hidden="true" tabindex="-1"></a>| *Smoking_History* | Patient's smoking history (Yes/No) | Categorical |</span>
<span id="cb33-149"><a href="#cb33-149" aria-hidden="true" tabindex="-1"></a>| *Diabetes_History* | History of diabetes (Yes/No) | Categorical |</span>
<span id="cb33-150"><a href="#cb33-150" aria-hidden="true" tabindex="-1"></a>| *Hypertension_History* | History of hypertension (Yes/No) | Categorical |</span>
<span id="cb33-151"><a href="#cb33-151" aria-hidden="true" tabindex="-1"></a>| *Cholesterol_Level* | Cholesterol level of the patient | Numerical Continuous |</span>
<span id="cb33-152"><a href="#cb33-152" aria-hidden="true" tabindex="-1"></a>| *Physical_Activity* | Level of physical activity (Low/Moderate/High) | Categorical |</span>
<span id="cb33-153"><a href="#cb33-153" aria-hidden="true" tabindex="-1"></a>| *Diet_Quality* | Quality of diet (Poor/Average/Good) | Categorical |</span>
<span id="cb33-154"><a href="#cb33-154" aria-hidden="true" tabindex="-1"></a>| *Alcohol_Consumption* | Frequency of alcohol consumption (Yes/No) | Categorical |</span>
<span id="cb33-155"><a href="#cb33-155" aria-hidden="true" tabindex="-1"></a>| *Stress_Levels* | Patient's stress levels (Low/Moderate/High) | Numerical Continuous |</span>
<span id="cb33-156"><a href="#cb33-156" aria-hidden="true" tabindex="-1"></a>| *BMI* | Body Mass Index of the patient | Numerical Continuous |</span>
<span id="cb33-157"><a href="#cb33-157" aria-hidden="true" tabindex="-1"></a>| *Heart_Rate* | Resting heart rate of the patient | Numerical Continuous |</span>
<span id="cb33-158"><a href="#cb33-158" aria-hidden="true" tabindex="-1"></a>| *Systolic_BP* | Systolic blood pressure | Numerical Continuous |</span>
<span id="cb33-159"><a href="#cb33-159" aria-hidden="true" tabindex="-1"></a>| *Diastolic_BP* | Diastolic blood pressure | Numerical Continuous |</span>
<span id="cb33-160"><a href="#cb33-160" aria-hidden="true" tabindex="-1"></a>| *Family_History* | Family history of heart disease (Yes/No) | Categorical |</span>
<span id="cb33-161"><a href="#cb33-161" aria-hidden="true" tabindex="-1"></a>| *Heart_Attack_Occurrence* | Whether the patient had a heart attack (Yes/No) | Categorical (Target) |</span>
<span id="cb33-162"><a href="#cb33-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-165"><a href="#cb33-165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-166"><a href="#cb33-166" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(jha_clean)</span>
<span id="cb33-167"><a href="#cb33-167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-168"><a href="#cb33-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-169"><a href="#cb33-169" aria-hidden="true" tabindex="-1"></a>After inspection, the variables are casted as the right data types. Hence, no modification is required.</span>
<span id="cb33-170"><a href="#cb33-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-171"><a href="#cb33-171" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.2.5 Removing Outliers</span></span>
<span id="cb33-172"><a href="#cb33-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-173"><a href="#cb33-173" aria-hidden="true" tabindex="-1"></a>To detect outliers, we will use the Z-Score method, which calculates how many standard deviations each data point is from the mean. Any data point with a Z-Score greater than 3 or less than -3 is typically considered an outlier.</span>
<span id="cb33-174"><a href="#cb33-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-177"><a href="#cb33-177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-178"><a href="#cb33-178" aria-hidden="true" tabindex="-1"></a>continuous_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Age"</span>, <span class="st">"Cholesterol_Level"</span>, <span class="st">"Stress_Levels"</span>, <span class="st">"BMI"</span>, <span class="st">"Heart_Rate"</span>, <span class="st">"Systolic_BP"</span>, <span class="st">"Diastolic_BP"</span>)</span>
<span id="cb33-179"><a href="#cb33-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-180"><a href="#cb33-180" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate Z-Score and identify outliers</span></span>
<span id="cb33-181"><a href="#cb33-181" aria-hidden="true" tabindex="-1"></a>z_score_outliers <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb33-182"><a href="#cb33-182" aria-hidden="true" tabindex="-1"></a>  z_scores <span class="ot">&lt;-</span> (x <span class="sc">-</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> <span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-183"><a href="#cb33-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">abs</span>(z_scores) <span class="sc">&gt;</span> <span class="dv">3</span>)</span>
<span id="cb33-184"><a href="#cb33-184" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-185"><a href="#cb33-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-186"><a href="#cb33-186" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(jha_clean[continuous_vars], z_score_outliers)</span>
<span id="cb33-187"><a href="#cb33-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-188"><a href="#cb33-188" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-189"><a href="#cb33-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-190"><a href="#cb33-190" aria-hidden="true" tabindex="-1"></a>To ensure our dataset is free from extreme values that might skew the analysis, we will clean the outliers detected using the Z-Score method.</span>
<span id="cb33-191"><a href="#cb33-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-192"><a href="#cb33-192" aria-hidden="true" tabindex="-1"></a>A maximum of 92 outliers were found in the numerical continuous variables of the dataset. As it is confirmed through further research that some of the values for these particular variables are out of the ordinary, a method suitable for dealing with these outliers was to remove them. Any observation with a Z-Score greater than 3 or less than -3 will be removed from the continuous numerical variables.</span>
<span id="cb33-193"><a href="#cb33-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-196"><a href="#cb33-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-197"><a href="#cb33-197" aria-hidden="true" tabindex="-1"></a>remove_outliers <span class="ot">&lt;-</span> <span class="cf">function</span>(df, cols) {</span>
<span id="cb33-198"><a href="#cb33-198" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (col <span class="cf">in</span> cols) {</span>
<span id="cb33-199"><a href="#cb33-199" aria-hidden="true" tabindex="-1"></a>    z_scores <span class="ot">&lt;-</span> (df[[col]] <span class="sc">-</span> <span class="fu">mean</span>(df[[col]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">/</span> <span class="fu">sd</span>(df[[col]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-200"><a href="#cb33-200" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> df[<span class="fu">abs</span>(z_scores) <span class="sc">&lt;=</span> <span class="dv">3</span>, ]  <span class="co"># Keep rows within Z-Score range</span></span>
<span id="cb33-201"><a href="#cb33-201" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-202"><a href="#cb33-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb33-203"><a href="#cb33-203" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-204"><a href="#cb33-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-205"><a href="#cb33-205" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove outliers</span></span>
<span id="cb33-206"><a href="#cb33-206" aria-hidden="true" tabindex="-1"></a>jha_clean <span class="ot">&lt;-</span> <span class="fu">remove_outliers</span>(jha_clean, continuous_vars)</span>
<span id="cb33-207"><a href="#cb33-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-208"><a href="#cb33-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-209"><a href="#cb33-209" aria-hidden="true" tabindex="-1"></a>After removing the outliers, the dataset now contains **29,596 observations** and **17 columns**.</span>
<span id="cb33-210"><a href="#cb33-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-211"><a href="#cb33-211" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.2.6 Creation of additional variables</span></span>
<span id="cb33-212"><a href="#cb33-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-213"><a href="#cb33-213" aria-hidden="true" tabindex="-1"></a>To enhance the analysis, we will create new categorical variables by binning continuous variables such as age, cholesterol level, BMI, heart rate, systolic blood pressure, and diastolic blood pressure.</span>
<span id="cb33-214"><a href="#cb33-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-215"><a href="#cb33-215" aria-hidden="true" tabindex="-1"></a>:::: callout-note</span>
<span id="cb33-216"><a href="#cb33-216" aria-hidden="true" tabindex="-1"></a>&lt;div&gt;</span>
<span id="cb33-217"><a href="#cb33-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-218"><a href="#cb33-218" aria-hidden="true" tabindex="-1"></a>Considerations when splitting the data:</span>
<span id="cb33-219"><a href="#cb33-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-220"><a href="#cb33-220" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Having equal splits (to prevent skew)</span>
<span id="cb33-221"><a href="#cb33-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-222"><a href="#cb33-222" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Medically relevant categories for better interpretation</span>
<span id="cb33-223"><a href="#cb33-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-224"><a href="#cb33-224" aria-hidden="true" tabindex="-1"></a>&lt;/div&gt;</span>
<span id="cb33-225"><a href="#cb33-225" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb33-226"><a href="#cb33-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-229"><a href="#cb33-229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-230"><a href="#cb33-230" aria-hidden="true" tabindex="-1"></a><span class="co"># Binning Age into categories</span></span>
<span id="cb33-231"><a href="#cb33-231" aria-hidden="true" tabindex="-1"></a>jha_clean <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb33-232"><a href="#cb33-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_Group =</span> <span class="fu">case_when</span>(</span>
<span id="cb33-233"><a href="#cb33-233" aria-hidden="true" tabindex="-1"></a>    Age <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"Youth"</span>,</span>
<span id="cb33-234"><a href="#cb33-234" aria-hidden="true" tabindex="-1"></a>    Age <span class="sc">&gt;=</span> <span class="dv">30</span> <span class="sc">&amp;</span> Age <span class="sc">&lt;</span> <span class="dv">50</span> <span class="sc">~</span> <span class="st">"Adult"</span>,</span>
<span id="cb33-235"><a href="#cb33-235" aria-hidden="true" tabindex="-1"></a>    Age <span class="sc">&gt;=</span> <span class="dv">50</span> <span class="sc">&amp;</span> Age <span class="sc">&lt;</span> <span class="dv">70</span> <span class="sc">~</span> <span class="st">"Middle-aged"</span>,</span>
<span id="cb33-236"><a href="#cb33-236" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Elderly"</span></span>
<span id="cb33-237"><a href="#cb33-237" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb33-238"><a href="#cb33-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-239"><a href="#cb33-239" aria-hidden="true" tabindex="-1"></a><span class="co"># Binning Cholesterol Level based on standard medical ranges</span></span>
<span id="cb33-240"><a href="#cb33-240" aria-hidden="true" tabindex="-1"></a>jha_clean <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb33-241"><a href="#cb33-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cholesterol_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb33-242"><a href="#cb33-242" aria-hidden="true" tabindex="-1"></a>    Cholesterol_Level <span class="sc">&lt;</span> <span class="dv">200</span> <span class="sc">~</span> <span class="st">"Desirable"</span>,</span>
<span id="cb33-243"><a href="#cb33-243" aria-hidden="true" tabindex="-1"></a>    Cholesterol_Level <span class="sc">&gt;=</span> <span class="dv">200</span> <span class="sc">&amp;</span> Cholesterol_Level <span class="sc">&lt;</span> <span class="dv">240</span> <span class="sc">~</span> <span class="st">"Borderline High"</span>,</span>
<span id="cb33-244"><a href="#cb33-244" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"High"</span></span>
<span id="cb33-245"><a href="#cb33-245" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb33-246"><a href="#cb33-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-247"><a href="#cb33-247" aria-hidden="true" tabindex="-1"></a><span class="co"># Binning BMI based on WHO weight status categories</span></span>
<span id="cb33-248"><a href="#cb33-248" aria-hidden="true" tabindex="-1"></a>jha_clean <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb33-249"><a href="#cb33-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BMI_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb33-250"><a href="#cb33-250" aria-hidden="true" tabindex="-1"></a>    BMI <span class="sc">&lt;</span> <span class="fl">18.5</span> <span class="sc">~</span> <span class="st">"Underweight"</span>,</span>
<span id="cb33-251"><a href="#cb33-251" aria-hidden="true" tabindex="-1"></a>    BMI <span class="sc">&gt;=</span> <span class="fl">18.5</span> <span class="sc">&amp;</span> BMI <span class="sc">&lt;</span> <span class="fl">24.9</span> <span class="sc">~</span> <span class="st">"Normal weight"</span>,</span>
<span id="cb33-252"><a href="#cb33-252" aria-hidden="true" tabindex="-1"></a>    BMI <span class="sc">&gt;=</span> <span class="dv">25</span> <span class="sc">&amp;</span> BMI <span class="sc">&lt;</span> <span class="fl">29.9</span> <span class="sc">~</span> <span class="st">"Overweight"</span>,</span>
<span id="cb33-253"><a href="#cb33-253" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Obese"</span></span>
<span id="cb33-254"><a href="#cb33-254" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb33-255"><a href="#cb33-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-256"><a href="#cb33-256" aria-hidden="true" tabindex="-1"></a><span class="co"># Binning Heart Rate into categories</span></span>
<span id="cb33-257"><a href="#cb33-257" aria-hidden="true" tabindex="-1"></a>jha_clean <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb33-258"><a href="#cb33-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Heart_Rate_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb33-259"><a href="#cb33-259" aria-hidden="true" tabindex="-1"></a>    Heart_Rate <span class="sc">&lt;</span> <span class="dv">60</span> <span class="sc">~</span> <span class="st">"Below Normal"</span>,</span>
<span id="cb33-260"><a href="#cb33-260" aria-hidden="true" tabindex="-1"></a>    Heart_Rate <span class="sc">&gt;=</span> <span class="dv">60</span> <span class="sc">&amp;</span> Heart_Rate <span class="sc">&lt;=</span> <span class="dv">100</span> <span class="sc">~</span> <span class="st">"Normal"</span>,</span>
<span id="cb33-261"><a href="#cb33-261" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Above Normal"</span></span>
<span id="cb33-262"><a href="#cb33-262" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb33-263"><a href="#cb33-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-264"><a href="#cb33-264" aria-hidden="true" tabindex="-1"></a><span class="co"># Binning Systolic BP based on AHA guidelines</span></span>
<span id="cb33-265"><a href="#cb33-265" aria-hidden="true" tabindex="-1"></a>jha_clean <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb33-266"><a href="#cb33-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Systolic_BP_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb33-267"><a href="#cb33-267" aria-hidden="true" tabindex="-1"></a>    Systolic_BP <span class="sc">&lt;</span> <span class="dv">120</span> <span class="sc">~</span> <span class="st">"Normal"</span>,</span>
<span id="cb33-268"><a href="#cb33-268" aria-hidden="true" tabindex="-1"></a>    Systolic_BP <span class="sc">&gt;=</span> <span class="dv">120</span> <span class="sc">&amp;</span> Systolic_BP <span class="sc">&lt;</span> <span class="dv">130</span> <span class="sc">~</span> <span class="st">"Elevated"</span>,</span>
<span id="cb33-269"><a href="#cb33-269" aria-hidden="true" tabindex="-1"></a>    Systolic_BP <span class="sc">&gt;=</span> <span class="dv">130</span> <span class="sc">&amp;</span> Systolic_BP <span class="sc">&lt;</span> <span class="dv">140</span> <span class="sc">~</span> <span class="st">"Hypertension Stage 1"</span>,</span>
<span id="cb33-270"><a href="#cb33-270" aria-hidden="true" tabindex="-1"></a>    Systolic_BP <span class="sc">&gt;=</span> <span class="dv">140</span> <span class="sc">~</span> <span class="st">"Hypertension Stage 2"</span></span>
<span id="cb33-271"><a href="#cb33-271" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb33-272"><a href="#cb33-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-273"><a href="#cb33-273" aria-hidden="true" tabindex="-1"></a><span class="co"># Binning Diastolic BP based on AHA guidelines</span></span>
<span id="cb33-274"><a href="#cb33-274" aria-hidden="true" tabindex="-1"></a>jha_clean <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb33-275"><a href="#cb33-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Diastolic_BP_Category =</span> <span class="fu">case_when</span>(</span>
<span id="cb33-276"><a href="#cb33-276" aria-hidden="true" tabindex="-1"></a>    Diastolic_BP <span class="sc">&lt;</span> <span class="dv">80</span> <span class="sc">~</span> <span class="st">"Normal"</span>,</span>
<span id="cb33-277"><a href="#cb33-277" aria-hidden="true" tabindex="-1"></a>    Diastolic_BP <span class="sc">&gt;=</span> <span class="dv">80</span> <span class="sc">&amp;</span> Diastolic_BP <span class="sc">&lt;</span> <span class="dv">90</span> <span class="sc">~</span> <span class="st">"Hypertension Stage 1"</span>,</span>
<span id="cb33-278"><a href="#cb33-278" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Hypertension Stage 2"</span></span>
<span id="cb33-279"><a href="#cb33-279" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb33-280"><a href="#cb33-280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-281"><a href="#cb33-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-282"><a href="#cb33-282" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.2.7 Checking of frequency distribution and skewness</span></span>
<span id="cb33-283"><a href="#cb33-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-284"><a href="#cb33-284" aria-hidden="true" tabindex="-1"></a>To ensure balanced data for modeling, we will check all categorical variables for class imbalances.</span>
<span id="cb33-285"><a href="#cb33-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-286"><a href="#cb33-286" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb33-287"><a href="#cb33-287" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code</span></span>
<span id="cb33-288"><a href="#cb33-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-291"><a href="#cb33-291" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-292"><a href="#cb33-292" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb33-293"><a href="#cb33-293" aria-hidden="true" tabindex="-1"></a>cat_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"Region"</span>, <span class="st">"Smoking_History"</span>, <span class="st">"Diabetes_History"</span>, </span>
<span id="cb33-294"><a href="#cb33-294" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Hypertension_History"</span>, <span class="st">"Physical_Activity"</span>, <span class="st">"Diet_Quality"</span>, </span>
<span id="cb33-295"><a href="#cb33-295" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Alcohol_Consumption"</span>, <span class="st">"Stress_Levels"</span>, <span class="st">"Family_History"</span>, </span>
<span id="cb33-296"><a href="#cb33-296" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Heart_Attack_Occurrence"</span>, <span class="st">"Age_Group"</span>, <span class="st">"Cholesterol_Category"</span>, </span>
<span id="cb33-297"><a href="#cb33-297" aria-hidden="true" tabindex="-1"></a>              <span class="st">"BMI_Category"</span>, <span class="st">"Heart_Rate_Category"</span>, <span class="st">"Systolic_BP_Category"</span>, <span class="st">"Diastolic_BP_Category"</span>)</span>
<span id="cb33-298"><a href="#cb33-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-299"><a href="#cb33-299" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> cat_vars) {</span>
<span id="cb33-300"><a href="#cb33-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, var, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-301"><a href="#cb33-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">table</span>(jha_clean[[var]]))</span>
<span id="cb33-302"><a href="#cb33-302" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-303"><a href="#cb33-303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-304"><a href="#cb33-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-305"><a href="#cb33-305" aria-hidden="true" tabindex="-1"></a><span class="fu">## Output</span></span>
<span id="cb33-306"><a href="#cb33-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-309"><a href="#cb33-309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-310"><a href="#cb33-310" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb33-311"><a href="#cb33-311" aria-hidden="true" tabindex="-1"></a>cat_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"Region"</span>, <span class="st">"Smoking_History"</span>, <span class="st">"Diabetes_History"</span>, </span>
<span id="cb33-312"><a href="#cb33-312" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Hypertension_History"</span>, <span class="st">"Physical_Activity"</span>, <span class="st">"Diet_Quality"</span>, </span>
<span id="cb33-313"><a href="#cb33-313" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Alcohol_Consumption"</span>, <span class="st">"Family_History"</span>, </span>
<span id="cb33-314"><a href="#cb33-314" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Heart_Attack_Occurrence"</span>, <span class="st">"Age_Group"</span>, <span class="st">"Cholesterol_Category"</span>, </span>
<span id="cb33-315"><a href="#cb33-315" aria-hidden="true" tabindex="-1"></a>              <span class="st">"BMI_Category"</span>, <span class="st">"Heart_Rate_Category"</span>, <span class="st">"Systolic_BP_Category"</span>, <span class="st">"Diastolic_BP_Category"</span>)</span>
<span id="cb33-316"><a href="#cb33-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-317"><a href="#cb33-317" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> cat_vars) {</span>
<span id="cb33-318"><a href="#cb33-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, var, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-319"><a href="#cb33-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">table</span>(jha_clean[[var]]))</span>
<span id="cb33-320"><a href="#cb33-320" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-321"><a href="#cb33-321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-322"><a href="#cb33-322" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb33-323"><a href="#cb33-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-324"><a href="#cb33-324" aria-hidden="true" tabindex="-1"></a>Next, we will also check for skewness in the continuous variables. Skewness indicates asymmetry in the data distribution, which can affect model predictions. Data with high skewness might require transformation for better model performance.</span>
<span id="cb33-325"><a href="#cb33-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-326"><a href="#cb33-326" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb33-327"><a href="#cb33-327" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code</span></span>
<span id="cb33-328"><a href="#cb33-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-331"><a href="#cb33-331" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-332"><a href="#cb33-332" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb33-333"><a href="#cb33-333" aria-hidden="true" tabindex="-1"></a>continuous_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Age"</span>, <span class="st">"Cholesterol_Level"</span>, <span class="st">"BMI"</span>, <span class="st">"Heart_Rate"</span>, <span class="st">"Systolic_BP"</span>, <span class="st">"Diastolic_BP"</span>)</span>
<span id="cb33-334"><a href="#cb33-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-335"><a href="#cb33-335" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(jha_clean[continuous_vars], skewness)</span>
<span id="cb33-336"><a href="#cb33-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-337"><a href="#cb33-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-338"><a href="#cb33-338" aria-hidden="true" tabindex="-1"></a><span class="fu">## Output</span></span>
<span id="cb33-339"><a href="#cb33-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-342"><a href="#cb33-342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-343"><a href="#cb33-343" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb33-344"><a href="#cb33-344" aria-hidden="true" tabindex="-1"></a>continuous_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Age"</span>, <span class="st">"Cholesterol_Level"</span>, <span class="st">"BMI"</span>, <span class="st">"Heart_Rate"</span>, <span class="st">"Systolic_BP"</span>, <span class="st">"Diastolic_BP"</span>)</span>
<span id="cb33-345"><a href="#cb33-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-346"><a href="#cb33-346" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(jha_clean[continuous_vars], skewness)</span>
<span id="cb33-347"><a href="#cb33-347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-348"><a href="#cb33-348" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb33-349"><a href="#cb33-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-350"><a href="#cb33-350" aria-hidden="true" tabindex="-1"></a>The skewness values are all close to 0, indicating that the continuous variables are approximately normally distributed. Since there is no significant skewness, no transformations are necessary for these variables before model training.</span>
<span id="cb33-351"><a href="#cb33-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-352"><a href="#cb33-352" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.2.8 Preview pre-processed dataframe</span></span>
<span id="cb33-353"><a href="#cb33-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-354"><a href="#cb33-354" aria-hidden="true" tabindex="-1"></a>Using <span class="in">`str()`</span>, we can observe that our pre-processed dataset now consists of **29,596 observations** and **23 columns**.</span>
<span id="cb33-355"><a href="#cb33-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-358"><a href="#cb33-358" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-359"><a href="#cb33-359" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(jha_clean)</span>
<span id="cb33-360"><a href="#cb33-360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-361"><a href="#cb33-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-362"><a href="#cb33-362" aria-hidden="true" tabindex="-1"></a><span class="fu"># 3. EDA</span></span>
<span id="cb33-363"><a href="#cb33-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-364"><a href="#cb33-364" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb33-365"><a href="#cb33-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-366"><a href="#cb33-366" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.1 Age Distribution by Heart Attack Occurrence</span></span>
<span id="cb33-367"><a href="#cb33-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-370"><a href="#cb33-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-371"><a href="#cb33-371" aria-hidden="true" tabindex="-1"></a>jha_clean<span class="sc">$</span>Heart_Attack_Occurrence <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(jha_clean<span class="sc">$</span>Heart_Attack_Occurrence)</span>
<span id="cb33-372"><a href="#cb33-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-373"><a href="#cb33-373" aria-hidden="true" tabindex="-1"></a>violin_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(jha_clean, <span class="fu">aes</span>(<span class="at">x =</span> Heart_Attack_Occurrence, <span class="at">y =</span> Age, <span class="at">fill =</span> Heart_Attack_Occurrence)) <span class="sc">+</span></span>
<span id="cb33-374"><a href="#cb33-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">scale =</span> <span class="st">"area"</span>) <span class="sc">+</span></span>
<span id="cb33-375"><a href="#cb33-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>), <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb33-376"><a href="#cb33-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>median, <span class="at">geom=</span><span class="st">"point"</span>, <span class="at">shape=</span><span class="dv">18</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb33-377"><a href="#cb33-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>median, <span class="at">geom=</span><span class="st">"text"</span>, <span class="fu">aes</span>(<span class="at">label=</span><span class="fu">round</span>(..y..,<span class="dv">1</span>)), <span class="at">vjust=</span><span class="sc">-</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb33-378"><a href="#cb33-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heart Attack Occurrence by Age Distribution"</span>,</span>
<span id="cb33-379"><a href="#cb33-379" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Heart Attack Occurrence"</span>, <span class="at">y =</span> <span class="st">"Age"</span>,</span>
<span id="cb33-380"><a href="#cb33-380" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Violin plot with boxplot overlay and Bar plot"</span>) <span class="sc">+</span></span>
<span id="cb33-381"><a href="#cb33-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb33-382"><a href="#cb33-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-383"><a href="#cb33-383" aria-hidden="true" tabindex="-1"></a>bar_plot <span class="ot">&lt;-</span> <span class="fu">ggbarstats</span>(jha_clean, </span>
<span id="cb33-384"><a href="#cb33-384" aria-hidden="true" tabindex="-1"></a>                       <span class="at">x =</span> Age_Group, </span>
<span id="cb33-385"><a href="#cb33-385" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> Heart_Attack_Occurrence)</span>
<span id="cb33-386"><a href="#cb33-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-387"><a href="#cb33-387" aria-hidden="true" tabindex="-1"></a>violin_plot <span class="sc">+</span> bar_plot <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb33-388"><a href="#cb33-388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-389"><a href="#cb33-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-390"><a href="#cb33-390" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="false"}</span>
<span id="cb33-391"><a href="#cb33-391" aria-hidden="true" tabindex="-1"></a><span class="fu">## Insight</span></span>
<span id="cb33-392"><a href="#cb33-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-393"><a href="#cb33-393" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Patients who experienced heart attacks (**49 years**) tend to be slightly older, with a median age higher than that of patients without heart attacks (**48 years**).</span>
<span id="cb33-394"><a href="#cb33-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-395"><a href="#cb33-395" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Both groups cover a similar age range, but the **density is higher in the adult and elderly brackets for heart attack cases**, suggesting a strong association between age and heart attack occurrence.</span>
<span id="cb33-396"><a href="#cb33-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-397"><a href="#cb33-397" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>To further confirm the observation that there is a strong association between age and heart attack occurence, a significant test of association was performed on the right. However, given the Cramer's V value (0.01), there seems to be a **weak association** between age group and heart attack occurrence.</span>
<span id="cb33-398"><a href="#cb33-398" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb33-399"><a href="#cb33-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-400"><a href="#cb33-400" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.2 Exploring relationships between Heart Attack Occurrence, by Age Group and Heart Rate</span></span>
<span id="cb33-401"><a href="#cb33-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-404"><a href="#cb33-404" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-405"><a href="#cb33-405" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure Age_Group are in order</span></span>
<span id="cb33-406"><a href="#cb33-406" aria-hidden="true" tabindex="-1"></a>jha_clean<span class="sc">$</span>Age_Group <span class="ot">&lt;-</span> <span class="fu">factor</span>(jha_clean<span class="sc">$</span>Age_Group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Youth"</span>, <span class="st">"Adult"</span>, <span class="st">"Middle-aged"</span>, <span class="st">"Elderly"</span>))</span>
<span id="cb33-407"><a href="#cb33-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-408"><a href="#cb33-408" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the faceted density plot</span></span>
<span id="cb33-409"><a href="#cb33-409" aria-hidden="true" tabindex="-1"></a>heart_rate_density <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> jha_clean, <span class="fu">aes</span>(<span class="at">x =</span> Heart_Rate, <span class="at">fill =</span> Heart_Attack_Occurrence)) <span class="sc">+</span>    </span>
<span id="cb33-410"><a href="#cb33-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb33-411"><a href="#cb33-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Age_Group, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">nrow =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb33-412"><a href="#cb33-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Heart Rate"</span>, <span class="at">y =</span> <span class="st">"Density"</span>, <span class="at">title =</span> <span class="st">"Heart Rate Distribution Across Age Groups"</span>, </span>
<span id="cb33-413"><a href="#cb33-413" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Density and Box plot of Heart Rate, colored by Heart Attack Occurrence"</span>) <span class="sc">+</span></span>
<span id="cb33-414"><a href="#cb33-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-415"><a href="#cb33-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb33-416"><a href="#cb33-416" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>), </span>
<span id="cb33-417"><a href="#cb33-417" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>), </span>
<span id="cb33-418"><a href="#cb33-418" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>), </span>
<span id="cb33-419"><a href="#cb33-419" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))</span>
<span id="cb33-420"><a href="#cb33-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-421"><a href="#cb33-421" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the boxplot</span></span>
<span id="cb33-422"><a href="#cb33-422" aria-hidden="true" tabindex="-1"></a>heart_rate_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(jha_clean, <span class="fu">aes</span>(<span class="at">x =</span> Age_Group, <span class="at">y =</span> Heart_Rate, <span class="at">fill =</span> Heart_Attack_Occurrence)) <span class="sc">+</span></span>
<span id="cb33-423"><a href="#cb33-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb33-424"><a href="#cb33-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb33-425"><a href="#cb33-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> median, <span class="at">geom =</span> <span class="st">"text"</span>,<span class="fu">aes</span>(<span class="at">label=</span><span class="fu">round</span>(..y..,<span class="dv">1</span>)), <span class="at">vjust=</span><span class="sc">-</span><span class="fl">1.0</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb33-426"><a href="#cb33-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(jha_clean<span class="sc">$</span>Heart_Rate), <span class="fu">max</span>(jha_clean<span class="sc">$</span>Heart_Rate))) <span class="sc">+</span></span>
<span id="cb33-427"><a href="#cb33-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-428"><a href="#cb33-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Heart Rate"</span>) <span class="sc">+</span></span>
<span id="cb33-429"><a href="#cb33-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">8</span>), </span>
<span id="cb33-430"><a href="#cb33-430" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>), <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))</span>
<span id="cb33-431"><a href="#cb33-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-432"><a href="#cb33-432" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots with adjusted layout</span></span>
<span id="cb33-433"><a href="#cb33-433" aria-hidden="true" tabindex="-1"></a>heart_rate_density <span class="sc">+</span> heart_rate_boxplot</span>
<span id="cb33-434"><a href="#cb33-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-435"><a href="#cb33-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-436"><a href="#cb33-436" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="false"}</span>
<span id="cb33-437"><a href="#cb33-437" aria-hidden="true" tabindex="-1"></a><span class="fu">## Insight</span></span>
<span id="cb33-438"><a href="#cb33-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-439"><a href="#cb33-439" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Across all age groups, patients who experienced heart attacks tend to have **slightly higher median heart rates** compared to those who did not.</span>
<span id="cb33-440"><a href="#cb33-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-441"><a href="#cb33-441" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In the Elderly group, the heart rates for patients with heart attacks are **more concentrated towards the higher end** of the scale.</span>
<span id="cb33-442"><a href="#cb33-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-443"><a href="#cb33-443" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Youth group show **a broader sprea**d of heart rates, with less distinction between patients with and without heart attacks.</span>
<span id="cb33-444"><a href="#cb33-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-445"><a href="#cb33-445" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Higher heart rates, especially in older age groups, might indicate an association with increased heart attack risk, though younger patients show less variation.</span>
<span id="cb33-446"><a href="#cb33-446" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb33-447"><a href="#cb33-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-448"><a href="#cb33-448" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.3 Impact of Historical Risk Factors on Heart Attack Incidence by Age Group</span></span>
<span id="cb33-449"><a href="#cb33-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-450"><a href="#cb33-450" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb33-451"><a href="#cb33-451" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code</span></span>
<span id="cb33-452"><a href="#cb33-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-455"><a href="#cb33-455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-456"><a href="#cb33-456" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb33-457"><a href="#cb33-457" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate heart attack percentages for each risk factor across age groups</span></span>
<span id="cb33-458"><a href="#cb33-458" aria-hidden="true" tabindex="-1"></a>risk_factors_summary <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb33-459"><a href="#cb33-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_Group) <span class="sc">%&gt;%</span></span>
<span id="cb33-460"><a href="#cb33-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb33-461"><a href="#cb33-461" aria-hidden="true" tabindex="-1"></a>    <span class="at">Smoking =</span> <span class="fu">mean</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> Smoking_History <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb33-462"><a href="#cb33-462" aria-hidden="true" tabindex="-1"></a>    <span class="at">Diabetes =</span> <span class="fu">mean</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> Diabetes_History <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb33-463"><a href="#cb33-463" aria-hidden="true" tabindex="-1"></a>    <span class="at">Hypertension =</span> <span class="fu">mean</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> Hypertension_History <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb33-464"><a href="#cb33-464" aria-hidden="true" tabindex="-1"></a>    <span class="at">Family_History =</span> <span class="fu">mean</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> Family_History <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb33-465"><a href="#cb33-465" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb33-466"><a href="#cb33-466" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-467"><a href="#cb33-467" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to long format for plotting</span></span>
<span id="cb33-468"><a href="#cb33-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb33-469"><a href="#cb33-469" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(Smoking, Diabetes, Hypertension, Family_History),</span>
<span id="cb33-470"><a href="#cb33-470" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Risk_Factor"</span>,</span>
<span id="cb33-471"><a href="#cb33-471" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Heart_Attack_Percentage"</span></span>
<span id="cb33-472"><a href="#cb33-472" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-473"><a href="#cb33-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-474"><a href="#cb33-474" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the visualization</span></span>
<span id="cb33-475"><a href="#cb33-475" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(risk_factors_summary, </span>
<span id="cb33-476"><a href="#cb33-476" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Age_Group, </span>
<span id="cb33-477"><a href="#cb33-477" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> Heart_Attack_Percentage, </span>
<span id="cb33-478"><a href="#cb33-478" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> Risk_Factor)) <span class="sc">+</span></span>
<span id="cb33-479"><a href="#cb33-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb33-480"><a href="#cb33-480" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="st">"dodge"</span>,</span>
<span id="cb33-481"><a href="#cb33-481" aria-hidden="true" tabindex="-1"></a>           <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb33-482"><a href="#cb33-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Heart_Attack_Percentage)),</span>
<span id="cb33-483"><a href="#cb33-483" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>),</span>
<span id="cb33-484"><a href="#cb33-484" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb33-485"><a href="#cb33-485" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb33-486"><a href="#cb33-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Smoking"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>, </span>
<span id="cb33-487"><a href="#cb33-487" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Diabetes"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>,</span>
<span id="cb33-488"><a href="#cb33-488" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Hypertension"</span> <span class="ot">=</span> <span class="st">"#009E73"</span>,</span>
<span id="cb33-489"><a href="#cb33-489" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Family_History"</span> <span class="ot">=</span> <span class="st">"#CC79A7"</span>)) <span class="sc">+</span></span>
<span id="cb33-490"><a href="#cb33-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heart Attack Occurrence by Risk Factors Across Age Groups"</span>,</span>
<span id="cb33-491"><a href="#cb33-491" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Percentage of heart attacks in patients with each risk factor"</span>,</span>
<span id="cb33-492"><a href="#cb33-492" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Group"</span>,</span>
<span id="cb33-493"><a href="#cb33-493" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage of Heart Attacks (%)"</span>) <span class="sc">+</span></span>
<span id="cb33-494"><a href="#cb33-494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-495"><a href="#cb33-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb33-496"><a href="#cb33-496" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb33-497"><a href="#cb33-497" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb33-498"><a href="#cb33-498" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb33-499"><a href="#cb33-499" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb33-500"><a href="#cb33-500" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb33-501"><a href="#cb33-501" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb33-502"><a href="#cb33-502" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb33-503"><a href="#cb33-503" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-504"><a href="#cb33-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-505"><a href="#cb33-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-506"><a href="#cb33-506" aria-hidden="true" tabindex="-1"></a><span class="fu">## Output</span></span>
<span id="cb33-507"><a href="#cb33-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-510"><a href="#cb33-510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-511"><a href="#cb33-511" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb33-512"><a href="#cb33-512" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate heart attack percentages for each risk factor across age groups</span></span>
<span id="cb33-513"><a href="#cb33-513" aria-hidden="true" tabindex="-1"></a>risk_factors_summary <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb33-514"><a href="#cb33-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Age_Group) <span class="sc">%&gt;%</span></span>
<span id="cb33-515"><a href="#cb33-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb33-516"><a href="#cb33-516" aria-hidden="true" tabindex="-1"></a>    <span class="at">Smoking =</span> <span class="fu">mean</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> Smoking_History <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb33-517"><a href="#cb33-517" aria-hidden="true" tabindex="-1"></a>    <span class="at">Diabetes =</span> <span class="fu">mean</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> Diabetes_History <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb33-518"><a href="#cb33-518" aria-hidden="true" tabindex="-1"></a>    <span class="at">Hypertension =</span> <span class="fu">mean</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> Hypertension_History <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb33-519"><a href="#cb33-519" aria-hidden="true" tabindex="-1"></a>    <span class="at">Family_History =</span> <span class="fu">mean</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> Family_History <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb33-520"><a href="#cb33-520" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb33-521"><a href="#cb33-521" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-522"><a href="#cb33-522" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert to long format for plotting</span></span>
<span id="cb33-523"><a href="#cb33-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb33-524"><a href="#cb33-524" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(Smoking, Diabetes, Hypertension, Family_History),</span>
<span id="cb33-525"><a href="#cb33-525" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Risk_Factor"</span>,</span>
<span id="cb33-526"><a href="#cb33-526" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Heart_Attack_Percentage"</span></span>
<span id="cb33-527"><a href="#cb33-527" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-528"><a href="#cb33-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-529"><a href="#cb33-529" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the visualization</span></span>
<span id="cb33-530"><a href="#cb33-530" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(risk_factors_summary, </span>
<span id="cb33-531"><a href="#cb33-531" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Age_Group, </span>
<span id="cb33-532"><a href="#cb33-532" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> Heart_Attack_Percentage, </span>
<span id="cb33-533"><a href="#cb33-533" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> Risk_Factor)) <span class="sc">+</span></span>
<span id="cb33-534"><a href="#cb33-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb33-535"><a href="#cb33-535" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="st">"dodge"</span>,</span>
<span id="cb33-536"><a href="#cb33-536" aria-hidden="true" tabindex="-1"></a>           <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb33-537"><a href="#cb33-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, Heart_Attack_Percentage)),</span>
<span id="cb33-538"><a href="#cb33-538" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>),</span>
<span id="cb33-539"><a href="#cb33-539" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb33-540"><a href="#cb33-540" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb33-541"><a href="#cb33-541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Smoking"</span> <span class="ot">=</span> <span class="st">"#D55E00"</span>, </span>
<span id="cb33-542"><a href="#cb33-542" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Diabetes"</span> <span class="ot">=</span> <span class="st">"#0072B2"</span>,</span>
<span id="cb33-543"><a href="#cb33-543" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Hypertension"</span> <span class="ot">=</span> <span class="st">"#009E73"</span>,</span>
<span id="cb33-544"><a href="#cb33-544" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Family_History"</span> <span class="ot">=</span> <span class="st">"#CC79A7"</span>)) <span class="sc">+</span></span>
<span id="cb33-545"><a href="#cb33-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heart Attack Occurrence by Risk Factors Across Age Groups"</span>,</span>
<span id="cb33-546"><a href="#cb33-546" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Percentage of heart attacks in patients with each risk factor"</span>,</span>
<span id="cb33-547"><a href="#cb33-547" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Group"</span>,</span>
<span id="cb33-548"><a href="#cb33-548" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage of Heart Attacks (%)"</span>) <span class="sc">+</span></span>
<span id="cb33-549"><a href="#cb33-549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-550"><a href="#cb33-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb33-551"><a href="#cb33-551" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb33-552"><a href="#cb33-552" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb33-553"><a href="#cb33-553" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb33-554"><a href="#cb33-554" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb33-555"><a href="#cb33-555" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb33-556"><a href="#cb33-556" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb33-557"><a href="#cb33-557" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb33-558"><a href="#cb33-558" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-559"><a href="#cb33-559" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-560"><a href="#cb33-560" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb33-561"><a href="#cb33-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-562"><a href="#cb33-562" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="false"}</span>
<span id="cb33-563"><a href="#cb33-563" aria-hidden="true" tabindex="-1"></a><span class="fu">## Insight</span></span>
<span id="cb33-564"><a href="#cb33-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-565"><a href="#cb33-565" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>All risk factors maintain relatively **consistent levels** across age groups (2.0-3.2% range)</span>
<span id="cb33-566"><a href="#cb33-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-567"><a href="#cb33-567" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Family History** seems to contribute to a higher risk of heart attack occurrence across age group after youth.</span>
<span id="cb33-568"><a href="#cb33-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-569"><a href="#cb33-569" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Smoking** consistently presents the highest risk across all age groups.</span>
<span id="cb33-570"><a href="#cb33-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-571"><a href="#cb33-571" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Surprisingly, younger age groups show **comparable risk levels** to older groups.</span>
<span id="cb33-572"><a href="#cb33-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-573"><a href="#cb33-573" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The combination of multiple risk factors might compound the risk, though this isn't shown in the visualization.</span>
<span id="cb33-574"><a href="#cb33-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-575"><a href="#cb33-575" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>No dramatic age-related increases in risk for any single factor, suggesting these are **relatively independent risk factors**.</span>
<span id="cb33-576"><a href="#cb33-576" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb33-577"><a href="#cb33-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-578"><a href="#cb33-578" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.1.4 Exploring Heart Attack Occurrence by demographic and lifestyle factors</span></span>
<span id="cb33-579"><a href="#cb33-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-580"><a href="#cb33-580" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb33-581"><a href="#cb33-581" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code</span></span>
<span id="cb33-582"><a href="#cb33-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-585"><a href="#cb33-585" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-586"><a href="#cb33-586" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb33-587"><a href="#cb33-587" aria-hidden="true" tabindex="-1"></a> <span class="co"># Prepare data focusing on Heart Attack Occurrence = "Yes" by demographic and lifestyle factors</span></span>
<span id="cb33-588"><a href="#cb33-588" aria-hidden="true" tabindex="-1"></a>heart_attack_focus <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb33-589"><a href="#cb33-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-590"><a href="#cb33-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Gender, Region, Physical_Activity, Diet_Quality, Alcohol_Consumption, Heart_Attack_Occurrence) <span class="sc">%&gt;%</span></span>
<span id="cb33-591"><a href="#cb33-591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Gender, Region, Physical_Activity, Diet_Quality, Alcohol_Consumption, Heart_Attack_Occurrence) <span class="sc">%&gt;%</span></span>
<span id="cb33-592"><a href="#cb33-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb33-593"><a href="#cb33-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-594"><a href="#cb33-594" aria-hidden="true" tabindex="-1"></a><span class="co"># Create parallel sets visualization focusing on heart attack occurrences for "Yes"</span></span>
<span id="cb33-595"><a href="#cb33-595" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heart_attack_focus,</span>
<span id="cb33-596"><a href="#cb33-596" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">axis1 =</span> Gender, </span>
<span id="cb33-597"><a href="#cb33-597" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis2 =</span> Region,</span>
<span id="cb33-598"><a href="#cb33-598" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis3 =</span> Physical_Activity,</span>
<span id="cb33-599"><a href="#cb33-599" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis4 =</span> Diet_Quality,</span>
<span id="cb33-600"><a href="#cb33-600" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis5 =</span> Alcohol_Consumption,</span>
<span id="cb33-601"><a href="#cb33-601" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb33-602"><a href="#cb33-602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_alluvium</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Heart_Attack_Occurrence), <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb33-603"><a href="#cb33-603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_stratum</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Heart_Attack_Occurrence), <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb33-604"><a href="#cb33-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"stratum"</span>,</span>
<span id="cb33-605"><a href="#cb33-605" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(stratum)), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb33-606"><a href="#cb33-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"#4682B4"</span>)) <span class="sc">+</span></span>
<span id="cb33-607"><a href="#cb33-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"Region"</span>, <span class="st">"Physical_Activity"</span>, <span class="st">"Diet_Quality"</span>, <span class="st">"Alcohol_Consumption"</span>),</span>
<span id="cb33-608"><a href="#cb33-608" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"Region"</span>, <span class="st">"Physical Activity"</span>, <span class="st">"Diet Quality"</span>, <span class="st">"Alcohol Consumption"</span>)) <span class="sc">+</span></span>
<span id="cb33-609"><a href="#cb33-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heart Attack Occurrence Distribution"</span>,</span>
<span id="cb33-610"><a href="#cb33-610" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Relation between Demographic and Lifestyle Factors to Heart Attack Occurrence"</span>,</span>
<span id="cb33-611"><a href="#cb33-611" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Demographic and Lifestyle Factors"</span>,</span>
<span id="cb33-612"><a href="#cb33-612" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb33-613"><a href="#cb33-613" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Heart Attack Occurrence"</span>) <span class="sc">+</span></span>
<span id="cb33-614"><a href="#cb33-614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-615"><a href="#cb33-615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb33-616"><a href="#cb33-616" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb33-617"><a href="#cb33-617" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb33-618"><a href="#cb33-618" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb33-619"><a href="#cb33-619" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb33-620"><a href="#cb33-620" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb33-621"><a href="#cb33-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-622"><a href="#cb33-622" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data focusing on Heart Attack Occurrence = "No" by demographic and lifestyle factors</span></span>
<span id="cb33-623"><a href="#cb33-623" aria-hidden="true" tabindex="-1"></a>no_heart_attack_focus <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb33-624"><a href="#cb33-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"No"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-625"><a href="#cb33-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Gender, Region, Physical_Activity, Diet_Quality, Alcohol_Consumption, Heart_Attack_Occurrence) <span class="sc">%&gt;%</span></span>
<span id="cb33-626"><a href="#cb33-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Gender, Region, Physical_Activity, Diet_Quality, Alcohol_Consumption, Heart_Attack_Occurrence) <span class="sc">%&gt;%</span></span>
<span id="cb33-627"><a href="#cb33-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb33-628"><a href="#cb33-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-629"><a href="#cb33-629" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the parallel sets visualization focusing on "No" heart attack occurrences</span></span>
<span id="cb33-630"><a href="#cb33-630" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(no_heart_attack_focus,</span>
<span id="cb33-631"><a href="#cb33-631" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">axis1 =</span> Gender, </span>
<span id="cb33-632"><a href="#cb33-632" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis2 =</span> Region,</span>
<span id="cb33-633"><a href="#cb33-633" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis3 =</span> Physical_Activity,</span>
<span id="cb33-634"><a href="#cb33-634" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis4 =</span> Diet_Quality,</span>
<span id="cb33-635"><a href="#cb33-635" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis5 =</span> Alcohol_Consumption,</span>
<span id="cb33-636"><a href="#cb33-636" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb33-637"><a href="#cb33-637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_alluvium</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Heart_Attack_Occurrence), <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb33-638"><a href="#cb33-638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_stratum</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Heart_Attack_Occurrence), <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb33-639"><a href="#cb33-639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"stratum"</span>,</span>
<span id="cb33-640"><a href="#cb33-640" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(stratum)), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb33-641"><a href="#cb33-641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"#D32F2F"</span>)) <span class="sc">+</span></span>
<span id="cb33-642"><a href="#cb33-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"Region"</span>, <span class="st">"Physical_Activity"</span>, <span class="st">"Diet_Quality"</span>, <span class="st">"Alcohol_Consumption"</span>),</span>
<span id="cb33-643"><a href="#cb33-643" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"Region"</span>, <span class="st">"Physical Activity"</span>, <span class="st">"Diet Quality"</span>, <span class="st">"Alcohol Consumption"</span>)) <span class="sc">+</span></span>
<span id="cb33-644"><a href="#cb33-644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heart Attack Occurrence Distribution"</span>,</span>
<span id="cb33-645"><a href="#cb33-645" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Relation between Demographic and Lifestyle Factors to Heart Attack Occurrence"</span>,</span>
<span id="cb33-646"><a href="#cb33-646" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Demographic and Lifestyle Factors"</span>,</span>
<span id="cb33-647"><a href="#cb33-647" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb33-648"><a href="#cb33-648" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Heart Attack Occurrence"</span>) <span class="sc">+</span></span>
<span id="cb33-649"><a href="#cb33-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-650"><a href="#cb33-650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb33-651"><a href="#cb33-651" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb33-652"><a href="#cb33-652" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb33-653"><a href="#cb33-653" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb33-654"><a href="#cb33-654" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb33-655"><a href="#cb33-655" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb33-656"><a href="#cb33-656" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-657"><a href="#cb33-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-658"><a href="#cb33-658" aria-hidden="true" tabindex="-1"></a><span class="fu">## Output</span></span>
<span id="cb33-659"><a href="#cb33-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-662"><a href="#cb33-662" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-663"><a href="#cb33-663" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb33-664"><a href="#cb33-664" aria-hidden="true" tabindex="-1"></a> <span class="co"># Prepare data focusing on Heart Attack Occurrence = "Yes" by demographic and lifestyle factors</span></span>
<span id="cb33-665"><a href="#cb33-665" aria-hidden="true" tabindex="-1"></a>heart_attack_focus <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb33-666"><a href="#cb33-666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-667"><a href="#cb33-667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Gender, Region, Physical_Activity, Diet_Quality, Alcohol_Consumption, Heart_Attack_Occurrence) <span class="sc">%&gt;%</span></span>
<span id="cb33-668"><a href="#cb33-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Gender, Region, Physical_Activity, Diet_Quality, Alcohol_Consumption, Heart_Attack_Occurrence) <span class="sc">%&gt;%</span></span>
<span id="cb33-669"><a href="#cb33-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb33-670"><a href="#cb33-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-671"><a href="#cb33-671" aria-hidden="true" tabindex="-1"></a><span class="co"># Create parallel sets visualization focusing on heart attack occurrences for "Yes"</span></span>
<span id="cb33-672"><a href="#cb33-672" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heart_attack_focus,</span>
<span id="cb33-673"><a href="#cb33-673" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">axis1 =</span> Gender, </span>
<span id="cb33-674"><a href="#cb33-674" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis2 =</span> Region,</span>
<span id="cb33-675"><a href="#cb33-675" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis3 =</span> Physical_Activity,</span>
<span id="cb33-676"><a href="#cb33-676" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis4 =</span> Diet_Quality,</span>
<span id="cb33-677"><a href="#cb33-677" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis5 =</span> Alcohol_Consumption,</span>
<span id="cb33-678"><a href="#cb33-678" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb33-679"><a href="#cb33-679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_alluvium</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Heart_Attack_Occurrence), <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb33-680"><a href="#cb33-680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_stratum</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Heart_Attack_Occurrence), <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb33-681"><a href="#cb33-681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"stratum"</span>,</span>
<span id="cb33-682"><a href="#cb33-682" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(stratum)), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb33-683"><a href="#cb33-683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"#4682B4"</span>)) <span class="sc">+</span></span>
<span id="cb33-684"><a href="#cb33-684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"Region"</span>, <span class="st">"Physical_Activity"</span>, <span class="st">"Diet_Quality"</span>, <span class="st">"Alcohol_Consumption"</span>),</span>
<span id="cb33-685"><a href="#cb33-685" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"Region"</span>, <span class="st">"Physical Activity"</span>, <span class="st">"Diet Quality"</span>, <span class="st">"Alcohol Consumption"</span>)) <span class="sc">+</span></span>
<span id="cb33-686"><a href="#cb33-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heart Attack Occurrence Distribution"</span>,</span>
<span id="cb33-687"><a href="#cb33-687" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Relation between Demographic and Lifestyle Factors to Heart Attack Occurrence"</span>,</span>
<span id="cb33-688"><a href="#cb33-688" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Demographic and Lifestyle Factors"</span>,</span>
<span id="cb33-689"><a href="#cb33-689" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb33-690"><a href="#cb33-690" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Heart Attack Occurrence"</span>) <span class="sc">+</span></span>
<span id="cb33-691"><a href="#cb33-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-692"><a href="#cb33-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb33-693"><a href="#cb33-693" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb33-694"><a href="#cb33-694" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb33-695"><a href="#cb33-695" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb33-696"><a href="#cb33-696" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb33-697"><a href="#cb33-697" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb33-698"><a href="#cb33-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-699"><a href="#cb33-699" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data focusing on Heart Attack Occurrence = "No" by demographic and lifestyle factors</span></span>
<span id="cb33-700"><a href="#cb33-700" aria-hidden="true" tabindex="-1"></a>no_heart_attack_focus <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb33-701"><a href="#cb33-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"No"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-702"><a href="#cb33-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Gender, Region, Physical_Activity, Diet_Quality, Alcohol_Consumption, Heart_Attack_Occurrence) <span class="sc">%&gt;%</span></span>
<span id="cb33-703"><a href="#cb33-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Gender, Region, Physical_Activity, Diet_Quality, Alcohol_Consumption, Heart_Attack_Occurrence) <span class="sc">%&gt;%</span></span>
<span id="cb33-704"><a href="#cb33-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb33-705"><a href="#cb33-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-706"><a href="#cb33-706" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the parallel sets visualization focusing on "No" heart attack occurrences</span></span>
<span id="cb33-707"><a href="#cb33-707" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(no_heart_attack_focus,</span>
<span id="cb33-708"><a href="#cb33-708" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">axis1 =</span> Gender, </span>
<span id="cb33-709"><a href="#cb33-709" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis2 =</span> Region,</span>
<span id="cb33-710"><a href="#cb33-710" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis3 =</span> Physical_Activity,</span>
<span id="cb33-711"><a href="#cb33-711" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis4 =</span> Diet_Quality,</span>
<span id="cb33-712"><a href="#cb33-712" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis5 =</span> Alcohol_Consumption,</span>
<span id="cb33-713"><a href="#cb33-713" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb33-714"><a href="#cb33-714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_alluvium</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Heart_Attack_Occurrence), <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb33-715"><a href="#cb33-715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_stratum</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Heart_Attack_Occurrence), <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb33-716"><a href="#cb33-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"stratum"</span>,</span>
<span id="cb33-717"><a href="#cb33-717" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(stratum)), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb33-718"><a href="#cb33-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"#D32F2F"</span>)) <span class="sc">+</span></span>
<span id="cb33-719"><a href="#cb33-719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"Region"</span>, <span class="st">"Physical_Activity"</span>, <span class="st">"Diet_Quality"</span>, <span class="st">"Alcohol_Consumption"</span>),</span>
<span id="cb33-720"><a href="#cb33-720" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"Region"</span>, <span class="st">"Physical Activity"</span>, <span class="st">"Diet Quality"</span>, <span class="st">"Alcohol Consumption"</span>)) <span class="sc">+</span></span>
<span id="cb33-721"><a href="#cb33-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heart Attack Occurrence Distribution"</span>,</span>
<span id="cb33-722"><a href="#cb33-722" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Relation between Demographic and Lifestyle Factors to Heart Attack Occurrence"</span>,</span>
<span id="cb33-723"><a href="#cb33-723" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Demographic and Lifestyle Factors"</span>,</span>
<span id="cb33-724"><a href="#cb33-724" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb33-725"><a href="#cb33-725" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Heart Attack Occurrence"</span>) <span class="sc">+</span></span>
<span id="cb33-726"><a href="#cb33-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-727"><a href="#cb33-727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb33-728"><a href="#cb33-728" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb33-729"><a href="#cb33-729" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb33-730"><a href="#cb33-730" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb33-731"><a href="#cb33-731" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb33-732"><a href="#cb33-732" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb33-733"><a href="#cb33-733" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-734"><a href="#cb33-734" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb33-735"><a href="#cb33-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-736"><a href="#cb33-736" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="\"false"}</span>
<span id="cb33-737"><a href="#cb33-737" aria-hidden="true" tabindex="-1"></a><span class="fu">## Insight</span></span>
<span id="cb33-738"><a href="#cb33-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-739"><a href="#cb33-739" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>There is a higher percentage of indivuals that experience heart attack coming from **urban regions** regardless of gender.</span>
<span id="cb33-740"><a href="#cb33-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-741"><a href="#cb33-741" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Moderate physical activity** is common among those with heart attacks.</span>
<span id="cb33-742"><a href="#cb33-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-743"><a href="#cb33-743" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Good and Average** **diet** appears to be linked to a higher occurrence of heart attacks.</span>
<span id="cb33-744"><a href="#cb33-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-745"><a href="#cb33-745" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Moderate and low alcohol consumption** shows the most notable presence in the heart attack group.</span>
<span id="cb33-746"><a href="#cb33-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-747"><a href="#cb33-747" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**General Insight**: Although the plot emphasizes the impact of **lifestyle factors** like **physical activity**, **diet**, and **alcohol consumption** on heart attack occurrence, it simply depicts the observations of these factors in the group of people with heart attack occurrence.</span>
<span id="cb33-748"><a href="#cb33-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-749"><a href="#cb33-749" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Further Investigation:** Upon further comparison with the group with no heart attack occurrence, it seems to exhibit a similar pattern to the group with hear attack occurrence. **Statistical studies** have to be performed to confirm if the pattern is more significant in one group than the other.</span>
<span id="cb33-750"><a href="#cb33-750" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb33-751"><a href="#cb33-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-752"><a href="#cb33-752" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.1.5 Exploring impact of risk factors on Heart Attack Occurence</span></span>
<span id="cb33-753"><a href="#cb33-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-756"><a href="#cb33-756" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-757"><a href="#cb33-757" aria-hidden="true" tabindex="-1"></a><span class="co"># Create binary risk factor columns (TRUE if risk factor present, FALSE otherwise)</span></span>
<span id="cb33-758"><a href="#cb33-758" aria-hidden="true" tabindex="-1"></a>jha_clean_filtered <span class="ot">&lt;-</span> jha_clean <span class="sc">%&gt;%</span></span>
<span id="cb33-759"><a href="#cb33-759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-760"><a href="#cb33-760" aria-hidden="true" tabindex="-1"></a>    <span class="at">smoking_risk =</span> <span class="fu">ifelse</span>(Smoking_History <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb33-761"><a href="#cb33-761" aria-hidden="true" tabindex="-1"></a>    <span class="at">diabetes_risk =</span> <span class="fu">ifelse</span>(Diabetes_History <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb33-762"><a href="#cb33-762" aria-hidden="true" tabindex="-1"></a>    <span class="at">hypertension_risk =</span> <span class="fu">ifelse</span>(Hypertension_History <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb33-763"><a href="#cb33-763" aria-hidden="true" tabindex="-1"></a>    <span class="at">cholesterol_risk =</span> <span class="fu">ifelse</span>(Cholesterol_Category <span class="sc">==</span> <span class="st">"High"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb33-764"><a href="#cb33-764" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi_risk =</span> <span class="fu">ifelse</span>(BMI_Category <span class="sc">==</span> <span class="st">"Obese"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb33-765"><a href="#cb33-765" aria-hidden="true" tabindex="-1"></a>    <span class="at">bp_risk =</span> <span class="fu">ifelse</span>(Systolic_BP_Category <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Hypertension Stage 1"</span>, <span class="st">"Hypertension Stage 2"</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb33-766"><a href="#cb33-766" aria-hidden="true" tabindex="-1"></a>    <span class="at">heart_rate_risk =</span> <span class="fu">ifelse</span>(Heart_Rate_Category <span class="sc">==</span> <span class="st">"Above Normal"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb33-767"><a href="#cb33-767" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-768"><a href="#cb33-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-769"><a href="#cb33-769" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the total number of risk factors for each individual</span></span>
<span id="cb33-770"><a href="#cb33-770" aria-hidden="true" tabindex="-1"></a>jha_clean_filtered <span class="ot">&lt;-</span> jha_clean_filtered <span class="sc">%&gt;%</span></span>
<span id="cb33-771"><a href="#cb33-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">risk_level =</span> smoking_risk <span class="sc">+</span> diabetes_risk <span class="sc">+</span> hypertension_risk <span class="sc">+</span> cholesterol_risk <span class="sc">+</span> bmi_risk <span class="sc">+</span> bp_risk <span class="sc">+</span> heart_rate_risk)</span>
<span id="cb33-772"><a href="#cb33-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-773"><a href="#cb33-773" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the number of individuals with each risk level (from 0 to 8 risk factors)</span></span>
<span id="cb33-774"><a href="#cb33-774" aria-hidden="true" tabindex="-1"></a>risk_summary <span class="ot">&lt;-</span> jha_clean_filtered <span class="sc">%&gt;%</span></span>
<span id="cb33-775"><a href="#cb33-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(risk_level) <span class="sc">%&gt;%</span></span>
<span id="cb33-776"><a href="#cb33-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb33-777"><a href="#cb33-777" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_patients =</span> <span class="fu">n</span>(),</span>
<span id="cb33-778"><a href="#cb33-778" aria-hidden="true" tabindex="-1"></a>    <span class="at">heart_attacks =</span> <span class="fu">sum</span>(Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>),</span>
<span id="cb33-779"><a href="#cb33-779" aria-hidden="true" tabindex="-1"></a>    <span class="at">risk_percentage =</span> (heart_attacks <span class="sc">/</span> total_patients) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb33-780"><a href="#cb33-780" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-781"><a href="#cb33-781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">risk_label =</span> <span class="fu">paste</span>(risk_level, <span class="st">"Risk Factors"</span>))</span>
<span id="cb33-782"><a href="#cb33-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-783"><a href="#cb33-783" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage of the population with each risk level</span></span>
<span id="cb33-784"><a href="#cb33-784" aria-hidden="true" tabindex="-1"></a>total_population <span class="ot">&lt;-</span> <span class="fu">nrow</span>(jha_clean_filtered)</span>
<span id="cb33-785"><a href="#cb33-785" aria-hidden="true" tabindex="-1"></a>risk_summary <span class="ot">&lt;-</span> risk_summary <span class="sc">%&gt;%</span></span>
<span id="cb33-786"><a href="#cb33-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">population_percentage =</span> (total_patients <span class="sc">/</span> total_population) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb33-787"><a href="#cb33-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-788"><a href="#cb33-788" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb33-789"><a href="#cb33-789" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(risk_summary)</span>
<span id="cb33-790"><a href="#cb33-790" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-791"><a href="#cb33-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-792"><a href="#cb33-792" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb33-793"><a href="#cb33-793" aria-hidden="true" tabindex="-1"></a><span class="fu">## Code</span></span>
<span id="cb33-794"><a href="#cb33-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-797"><a href="#cb33-797" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-798"><a href="#cb33-798" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb33-799"><a href="#cb33-799" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(risk_summary, </span>
<span id="cb33-800"><a href="#cb33-800" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> risk_level, <span class="at">y =</span> risk_percentage)) <span class="sc">+</span></span>
<span id="cb33-801"><a href="#cb33-801" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"#2C7BB6"</span>) <span class="sc">+</span></span>
<span id="cb33-802"><a href="#cb33-802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> total_patients), </span>
<span id="cb33-803"><a href="#cb33-803" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#2C7BB6"</span>, </span>
<span id="cb33-804"><a href="#cb33-804" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb33-805"><a href="#cb33-805" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, risk_percentage)),</span>
<span id="cb33-806"><a href="#cb33-806" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb33-807"><a href="#cb33-807" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb33-808"><a href="#cb33-808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"n ="</span>, total_patients)),</span>
<span id="cb33-809"><a href="#cb33-809" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">2</span>, </span>
<span id="cb33-810"><a href="#cb33-810" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb33-811"><a href="#cb33-811" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, </span>
<span id="cb33-812"><a href="#cb33-812" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1 Risk Factor"</span>, <span class="st">"2 Risk Factors"</span>, <span class="st">"3 Risk Factors"</span>, <span class="st">"4 Risk Factors"</span>, <span class="st">"5 Risk Factors"</span>, <span class="st">"6 Risk Factors"</span>)) <span class="sc">+</span></span>
<span id="cb33-813"><a href="#cb33-813" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb33-814"><a href="#cb33-814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Impact of Risk Factors on Heart Attack Occurrence"</span>,</span>
<span id="cb33-815"><a href="#cb33-815" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Percentage of heart attacks increases as more risk factors accumulate"</span>,</span>
<span id="cb33-816"><a href="#cb33-816" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Accumulated Risk Factors"</span>,</span>
<span id="cb33-817"><a href="#cb33-817" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Heart Attack Occurrence (%)"</span>) <span class="sc">+</span></span>
<span id="cb33-818"><a href="#cb33-818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-819"><a href="#cb33-819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb33-820"><a href="#cb33-820" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb33-821"><a href="#cb33-821" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb33-822"><a href="#cb33-822" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb33-823"><a href="#cb33-823" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb33-824"><a href="#cb33-824" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb33-825"><a href="#cb33-825" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-826"><a href="#cb33-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-827"><a href="#cb33-827" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-828"><a href="#cb33-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-829"><a href="#cb33-829" aria-hidden="true" tabindex="-1"></a><span class="fu">## Output</span></span>
<span id="cb33-830"><a href="#cb33-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-833"><a href="#cb33-833" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-834"><a href="#cb33-834" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb33-835"><a href="#cb33-835" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(risk_summary, </span>
<span id="cb33-836"><a href="#cb33-836" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> risk_level, <span class="at">y =</span> risk_percentage)) <span class="sc">+</span></span>
<span id="cb33-837"><a href="#cb33-837" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"#2C7BB6"</span>) <span class="sc">+</span></span>
<span id="cb33-838"><a href="#cb33-838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> total_patients), </span>
<span id="cb33-839"><a href="#cb33-839" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#2C7BB6"</span>, </span>
<span id="cb33-840"><a href="#cb33-840" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb33-841"><a href="#cb33-841" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, risk_percentage)),</span>
<span id="cb33-842"><a href="#cb33-842" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb33-843"><a href="#cb33-843" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb33-844"><a href="#cb33-844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"n ="</span>, total_patients)),</span>
<span id="cb33-845"><a href="#cb33-845" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">2</span>, </span>
<span id="cb33-846"><a href="#cb33-846" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb33-847"><a href="#cb33-847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, </span>
<span id="cb33-848"><a href="#cb33-848" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1 Risk Factor"</span>, <span class="st">"2 Risk Factors"</span>, <span class="st">"3 Risk Factors"</span>, <span class="st">"4 Risk Factors"</span>, <span class="st">"5 Risk Factors"</span>, <span class="st">"6 Risk Factors"</span>)) <span class="sc">+</span></span>
<span id="cb33-849"><a href="#cb33-849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb33-850"><a href="#cb33-850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Impact of Risk Factors on Heart Attack Occurrence"</span>,</span>
<span id="cb33-851"><a href="#cb33-851" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Percentage of heart attacks increases as more risk factors accumulate"</span>,</span>
<span id="cb33-852"><a href="#cb33-852" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Accumulated Risk Factors"</span>,</span>
<span id="cb33-853"><a href="#cb33-853" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Heart Attack Occurrence (%)"</span>) <span class="sc">+</span></span>
<span id="cb33-854"><a href="#cb33-854" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-855"><a href="#cb33-855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb33-856"><a href="#cb33-856" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb33-857"><a href="#cb33-857" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb33-858"><a href="#cb33-858" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb33-859"><a href="#cb33-859" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb33-860"><a href="#cb33-860" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb33-861"><a href="#cb33-861" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-862"><a href="#cb33-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-863"><a href="#cb33-863" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-864"><a href="#cb33-864" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb33-865"><a href="#cb33-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-866"><a href="#cb33-866" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb33-867"><a href="#cb33-867" aria-hidden="true" tabindex="-1"></a><span class="fu">## Insight</span></span>
<span id="cb33-868"><a href="#cb33-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-869"><a href="#cb33-869" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The percentage of heart attacks remains relatively stable (around 9.9%) for individuals with **1 to 3 risk factors**, indicating that a few risk factors don’t dramatically increase heart attack occurrence.</span>
<span id="cb33-870"><a href="#cb33-870" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>With **4 to 5 risk factors**, the heart attack occurrence percentage rises slightly to 10.0% and 10.6%, showing a modest increase in risk.</span>
<span id="cb33-871"><a href="#cb33-871" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>At **6 risk factors**, the heart attack occurrence drops sharply to 0%, likely due to a very small sample size (only 49 individuals), suggesting unreliable data for this group.</span>
<span id="cb33-872"><a href="#cb33-872" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Larger sample sizes at 1 to 3 risk factors ensure more reliable results, while smaller sample sizes at higher risk levels lead to potential inconsistencies.</span>
<span id="cb33-873"><a href="#cb33-873" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The overall trend indicates that heart attack risk **increases slightly with the accumulation of risk factors** up to 5.</span>
<span id="cb33-874"><a href="#cb33-874" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb33-875"><a href="#cb33-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-876"><a href="#cb33-876" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.1.6 Summary</span></span>
<span id="cb33-877"><a href="#cb33-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-878"><a href="#cb33-878" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3.1.6.1 Conclusion</span></span>
<span id="cb33-879"><a href="#cb33-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-880"><a href="#cb33-880" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Age and Heart Attack:** Adult and Middle-Age patients tend to have higher heart attack occurrences, but the weak association with age suggests that further analysis is needed to better understand its impact.</span>
<span id="cb33-881"><a href="#cb33-881" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Heart Rate and Risk:** Patients with heart attacks show slightly higher heart rates, especially in older age groups. While there is a trend, more analysis is required to confirm its significance.</span>
<span id="cb33-882"><a href="#cb33-882" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Risk Factors:** Smoking is the most consistent risk factor across age groups, while family history increases risk in older individuals. Risk factors appear to act independently.</span>
<span id="cb33-883"><a href="#cb33-883" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Lifestyle Factors:** Physical activity, diet, and alcohol consumption are linked to heart attack occurrence, but similar patterns are seen in both heart attack and non-heart attack groups.</span>
<span id="cb33-884"><a href="#cb33-884" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Accumulated Risk:** Heart attack occurrence increases slightly with the accumulation of 1 to 5 risk factors. However, due to small sample sizes at higher risk levels, further modeling and collection of data for risk levels 6 and above are required for more reliable insights.</span>
<span id="cb33-885"><a href="#cb33-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-886"><a href="#cb33-886" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3.1.6.2 Future Work</span></span>
<span id="cb33-887"><a href="#cb33-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-888"><a href="#cb33-888" aria-hidden="true" tabindex="-1"></a>While the visualizations provide useful observations, further statistical analyses and modeling techniques (e.g., logistic regression, decision trees) are essential to better explain the true impact of individual and combined variables on heart attack occurrence. These models can help quantify the relative contribution of each variable, determine interactions between risk factors and potentially identify new insights that can inform preventive measures and interventions for heart attacks.</span>
<span id="cb33-889"><a href="#cb33-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-890"><a href="#cb33-890" aria-hidden="true" tabindex="-1"></a><span class="fu"># References</span></span>
<span id="cb33-891"><a href="#cb33-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-892"><a href="#cb33-892" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Prof Kam Tin Seong (2025) https://r4va.netlify.app/. Online version.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>